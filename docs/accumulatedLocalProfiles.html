<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Accumulated Local Profiles | Predictive Models: Explore, Explain, and Debug</title>
  <meta name="description" content="This book introduces key concepts for exploration, explanation and visualization of complex predictive models." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Accumulated Local Profiles | Predictive Models: Explore, Explain, and Debug" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book introduces key concepts for exploration, explanation and visualization of complex predictive models." />
  <meta name="github-repo" content="pbiecek/PM_VEE" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Accumulated Local Profiles | Predictive Models: Explore, Explain, and Debug" />
  
  <meta name="twitter:description" content="This book introduces key concepts for exploration, explanation and visualization of complex predictive models." />
  

<meta name="author" content="Przemyslaw Biecek and Tomasz Burzykowski" />


<meta name="date" content="2019-12-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="partialDependenceProfiles.html"/>
<link rel="next" href="residualDiagnostic.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-5650686-15', 'https://pbiecek.github.io/PM_VEE/', {
  'anonymizeIp': true
  , 'storage': 'none'
  , 'clientId': window.localStorage.getItem('ga_clientId')
});
ga(function(tracker) {
  window.localStorage.setItem('ga_clientId', tracker.get('clientId'));
});
ga('send', 'pageview');
</script>
<style>
.figure {
   padding:40px 0px;
}
</style>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Predictive Models: Explore, Explain, and Debug<br/> Human-Centered Interpretable Machine Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#notes-to-readers"><i class="fa fa-check"></i><b>1.1</b> Notes to readers</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-aim-of-the-book"><i class="fa fa-check"></i><b>1.2</b> The aim of the book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#three-single-laws"><i class="fa fa-check"></i><b>1.3</b> A bit of philosophy: three laws of model explanation</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#bookstructure"><i class="fa fa-check"></i><b>1.4</b> The structure of the book</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#terminology"><i class="fa fa-check"></i><b>1.5</b> Terminology</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#glass-box-models-vs.black-box-models"><i class="fa fa-check"></i><b>1.6</b> Glass-box models vs. black-box models</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#model-agnostic-vs.model-specific-approach"><i class="fa fa-check"></i><b>1.7</b> Model-agnostic vs. model-specific approach</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#what-is-in-this-book-and-what-is-not"><i class="fa fa-check"></i><b>1.8</b> What is in this book and what is not</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#thanksto"><i class="fa fa-check"></i><b>1.9</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html"><i class="fa fa-check"></i><b>2</b> Model Development</a><ul>
<li class="chapter" data-level="2.1" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#notation"><i class="fa fa-check"></i><b>2.1</b> Notation - from introduction</a></li>
<li class="chapter" data-level="2.2" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#model-visualization-exploration-and-explanation---from-introduction"><i class="fa fa-check"></i><b>2.2</b> Model visualization, exploration, and explanation - from introduction</a></li>
<li class="chapter" data-level="2.3" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#MDPIntro"><i class="fa fa-check"></i><b>2.3</b> Introduction</a></li>
<li class="chapter" data-level="2.4" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#the-process"><i class="fa fa-check"></i><b>2.4</b> The Process</a></li>
<li class="chapter" data-level="2.5" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#data-preparation"><i class="fa fa-check"></i><b>2.5</b> Data preparation</a></li>
<li class="chapter" data-level="2.6" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#data-exploration"><i class="fa fa-check"></i><b>2.6</b> Data exploration</a></li>
<li class="chapter" data-level="2.7" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#model-assembly"><i class="fa fa-check"></i><b>2.7</b> Model assembly</a></li>
<li class="chapter" data-level="2.8" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#model-understanding"><i class="fa fa-check"></i><b>2.8</b> Model understanding</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html"><i class="fa fa-check"></i><b>3</b> Do-it-yourself With R</a><ul>
<li class="chapter" data-level="3.1" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#what-to-install"><i class="fa fa-check"></i><b>3.1</b> What to install?</a></li>
<li class="chapter" data-level="3.2" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#how-to-work-with-dalex"><i class="fa fa-check"></i><b>3.2</b> How to work with <code>DALEX</code>?</a></li>
<li class="chapter" data-level="3.3" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#how-to-work-with-archivist"><i class="fa fa-check"></i><b>3.3</b> How to work with <code>archivist</code>?</a></li>
<li class="chapter" data-level="3.4" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#Packages"><i class="fa fa-check"></i><b>3.4</b> DrWhy Packages</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="doItYourselfWithPython.html"><a href="doItYourselfWithPython.html"><i class="fa fa-check"></i><b>4</b> Do-it-yourself With Python</a></li>
<li class="chapter" data-level="5" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html"><i class="fa fa-check"></i><b>5</b> Data sets and models</a><ul>
<li class="chapter" data-level="5.1" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#TitanicDataset"><i class="fa fa-check"></i><b>5.1</b> Sinking of the RMS Titanic</a><ul>
<li class="chapter" data-level="5.1.1" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#exploration-titanic"><i class="fa fa-check"></i><b>5.1.1</b> Data exploration</a></li>
<li class="chapter" data-level="5.1.2" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-titanic-lmr"><i class="fa fa-check"></i><b>5.1.2</b> Logistic regression</a></li>
<li class="chapter" data-level="5.1.3" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-titanic-rf"><i class="fa fa-check"></i><b>5.1.3</b> Random forest</a></li>
<li class="chapter" data-level="5.1.4" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-titanic-gbm"><i class="fa fa-check"></i><b>5.1.4</b> Gradient boosting</a></li>
<li class="chapter" data-level="5.1.5" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#predictions-titanic"><i class="fa fa-check"></i><b>5.1.5</b> Model predictions</a></li>
<li class="chapter" data-level="5.1.6" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ExplainersTitanicRCode"><i class="fa fa-check"></i><b>5.1.6</b> Explainers</a></li>
<li class="chapter" data-level="5.1.7" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ListOfModelsTitanic"><i class="fa fa-check"></i><b>5.1.7</b> List of objects for the <code>titanic</code> example</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ApartmentDataset"><i class="fa fa-check"></i><b>5.2</b> Apartment prices</a><ul>
<li class="chapter" data-level="5.2.1" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#exploration-apartments"><i class="fa fa-check"></i><b>5.2.1</b> Data exploration</a></li>
<li class="chapter" data-level="5.2.2" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-Apartments-lr"><i class="fa fa-check"></i><b>5.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="5.2.3" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-Apartments-rf"><i class="fa fa-check"></i><b>5.2.3</b> Random forest</a></li>
<li class="chapter" data-level="5.2.4" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#predictionsApartments"><i class="fa fa-check"></i><b>5.2.4</b> Model predictions</a></li>
<li class="chapter" data-level="5.2.5" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ExplainersApartmentsRCode"><i class="fa fa-check"></i><b>5.2.5</b> Explainers</a></li>
<li class="chapter" data-level="5.2.6" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ListOfModelsApartments"><i class="fa fa-check"></i><b>5.2.6</b> List of objects for the <code>apartments</code> example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="instance-level.html"><a href="instance-level.html"><i class="fa fa-check"></i>Instance Level</a></li>
<li class="chapter" data-level="6" data-path="InstanceLevelExploration.html"><a href="InstanceLevelExploration.html"><i class="fa fa-check"></i><b>6</b> Introduction to Instance Level Exploration</a></li>
<li class="chapter" data-level="7" data-path="breakDown.html"><a href="breakDown.html"><i class="fa fa-check"></i><b>7</b> Break-down Plots for Additive Variable Attributions</a><ul>
<li class="chapter" data-level="7.1" data-path="breakDown.html"><a href="breakDown.html#BDIntuition"><i class="fa fa-check"></i><b>7.1</b> Intuition</a></li>
<li class="chapter" data-level="7.2" data-path="breakDown.html"><a href="breakDown.html#BDMethod"><i class="fa fa-check"></i><b>7.2</b> Method</a><ul>
<li class="chapter" data-level="7.2.1" data-path="breakDown.html"><a href="breakDown.html#break-down-for-linear-models"><i class="fa fa-check"></i><b>7.2.1</b> Break-down for linear models</a></li>
<li class="chapter" data-level="7.2.2" data-path="breakDown.html"><a href="breakDown.html#break-down-for-general-case"><i class="fa fa-check"></i><b>7.2.2</b> Break-down for general case</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="breakDown.html"><a href="breakDown.html#BDExample"><i class="fa fa-check"></i><b>7.3</b> Example: Titanic data</a></li>
<li class="chapter" data-level="7.4" data-path="breakDown.html"><a href="breakDown.html#BDProsCons"><i class="fa fa-check"></i><b>7.4</b> Pros and cons</a></li>
<li class="chapter" data-level="7.5" data-path="breakDown.html"><a href="breakDown.html#BDR"><i class="fa fa-check"></i><b>7.5</b> Code snippets for R</a><ul>
<li class="chapter" data-level="7.5.1" data-path="breakDown.html"><a href="breakDown.html#basic-use-of-the-break_down-function"><i class="fa fa-check"></i><b>7.5.1</b> Basic use of the <code>break_down()</code> function</a></li>
<li class="chapter" data-level="7.5.2" data-path="breakDown.html"><a href="breakDown.html#advanced-use-of-the-break_down-function"><i class="fa fa-check"></i><b>7.5.2</b> Advanced use of the <code>break_down()</code> function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="iBreakDown.html"><a href="iBreakDown.html"><i class="fa fa-check"></i><b>8</b> Break-down Plots for Models with Interactions (iBreak-down Plots)</a><ul>
<li class="chapter" data-level="8.1" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDIntuition"><i class="fa fa-check"></i><b>8.1</b> Intuition</a></li>
<li class="chapter" data-level="8.2" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDMethod"><i class="fa fa-check"></i><b>8.2</b> Method</a></li>
<li class="chapter" data-level="8.3" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDExample"><i class="fa fa-check"></i><b>8.3</b> Example: Titanic data</a></li>
<li class="chapter" data-level="8.4" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDProsCons"><i class="fa fa-check"></i><b>8.4</b> Pros and cons</a></li>
<li class="chapter" data-level="8.5" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDRcode"><i class="fa fa-check"></i><b>8.5</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="shapley.html"><a href="shapley.html"><i class="fa fa-check"></i><b>9</b> Shapley Additive Explanations (SHAP) and Average Variable Attributions</a><ul>
<li class="chapter" data-level="9.1" data-path="shapley.html"><a href="shapley.html#SHAPIntuition"><i class="fa fa-check"></i><b>9.1</b> Intuition</a></li>
<li class="chapter" data-level="9.2" data-path="shapley.html"><a href="shapley.html#SHAPMethod"><i class="fa fa-check"></i><b>9.2</b> Method</a></li>
<li class="chapter" data-level="9.3" data-path="shapley.html"><a href="shapley.html#SHAPExample"><i class="fa fa-check"></i><b>9.3</b> Example: Titanic data</a></li>
<li class="chapter" data-level="9.4" data-path="shapley.html"><a href="shapley.html#SHAProsCons"><i class="fa fa-check"></i><b>9.4</b> Pros and cons</a></li>
<li class="chapter" data-level="9.5" data-path="shapley.html"><a href="shapley.html#SHAPRcode"><i class="fa fa-check"></i><b>9.5</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="LIME.html"><a href="LIME.html"><i class="fa fa-check"></i><b>10</b> Local Interpretable Model-agnostic Explanations (LIME)</a><ul>
<li class="chapter" data-level="10.1" data-path="LIME.html"><a href="LIME.html#LIMEIntroduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="LIME.html"><a href="LIME.html#LIMEIntuition"><i class="fa fa-check"></i><b>10.2</b> Intuition</a></li>
<li class="chapter" data-level="10.3" data-path="LIME.html"><a href="LIME.html#LIMEMethod"><i class="fa fa-check"></i><b>10.3</b> Method</a><ul>
<li class="chapter" data-level="10.3.1" data-path="LIME.html"><a href="LIME.html#interpretable-data-representation"><i class="fa fa-check"></i><b>10.3.1</b> Interpretable data representation</a></li>
<li class="chapter" data-level="10.3.2" data-path="LIME.html"><a href="LIME.html#sampling-around-the-instance-of-interest"><i class="fa fa-check"></i><b>10.3.2</b> Sampling around the instance of interest</a></li>
<li class="chapter" data-level="10.3.3" data-path="LIME.html"><a href="LIME.html#developing-the-white-box-model"><i class="fa fa-check"></i><b>10.3.3</b> Developing the white-box model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="LIME.html"><a href="LIME.html#LIMEExample"><i class="fa fa-check"></i><b>10.4</b> Example: Titanic data</a></li>
<li class="chapter" data-level="10.5" data-path="LIME.html"><a href="LIME.html#LIMEProsCons"><i class="fa fa-check"></i><b>10.5</b> Pros and cons</a></li>
<li class="chapter" data-level="10.6" data-path="LIME.html"><a href="LIME.html#LIMERcode"><i class="fa fa-check"></i><b>10.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="10.6.1" data-path="LIME.html"><a href="LIME.html#the-lime-package"><i class="fa fa-check"></i><b>10.6.1</b> The lime package</a></li>
<li class="chapter" data-level="10.6.2" data-path="LIME.html"><a href="LIME.html#the-localmodel-package"><i class="fa fa-check"></i><b>10.6.2</b> The localModel package</a></li>
<li class="chapter" data-level="10.6.3" data-path="LIME.html"><a href="LIME.html#the-iml-package"><i class="fa fa-check"></i><b>10.6.3</b> The iml package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ceterisParibus.html"><a href="ceterisParibus.html"><i class="fa fa-check"></i><b>11</b> Ceteris-paribus Profiles and What-If Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPIntro"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPIntuition"><i class="fa fa-check"></i><b>11.2</b> Intuition</a></li>
<li class="chapter" data-level="11.3" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPMethod"><i class="fa fa-check"></i><b>11.3</b> Method</a></li>
<li class="chapter" data-level="11.4" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPExample"><i class="fa fa-check"></i><b>11.4</b> Example: Titanic</a></li>
<li class="chapter" data-level="11.5" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPProsCons"><i class="fa fa-check"></i><b>11.5</b> Pros and cons</a></li>
<li class="chapter" data-level="11.6" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPR"><i class="fa fa-check"></i><b>11.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="11.6.1" data-path="ceterisParibus.html"><a href="ceterisParibus.html#basic-use-of-the-ceteris_paribus-function"><i class="fa fa-check"></i><b>11.6.1</b> Basic use of the <code>ceteris_paribus</code> function</a></li>
<li class="chapter" data-level="11.6.2" data-path="ceterisParibus.html"><a href="ceterisParibus.html#advanced-use-of-the-ceteris_paribus-function"><i class="fa fa-check"></i><b>11.6.2</b> Advanced use of the <code>ceteris_paribus</code> function</a></li>
<li class="chapter" data-level="11.6.3" data-path="ceterisParibus.html"><a href="ceterisParibus.html#champion-challenger-analysis"><i class="fa fa-check"></i><b>11.6.3</b> Champion-challenger analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html"><i class="fa fa-check"></i><b>12</b> Ceteris-paribus Oscillations and Local Variable-importance</a><ul>
<li class="chapter" data-level="12.1" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscIntro"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscIntuition"><i class="fa fa-check"></i><b>12.2</b> Intuition</a></li>
<li class="chapter" data-level="12.3" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscMethod"><i class="fa fa-check"></i><b>12.3</b> Method</a></li>
<li class="chapter" data-level="12.4" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscExample"><i class="fa fa-check"></i><b>12.4</b> Example: Titanic</a></li>
<li class="chapter" data-level="12.5" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscProsCons"><i class="fa fa-check"></i><b>12.5</b> Pros and cons</a></li>
<li class="chapter" data-level="12.6" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscR"><i class="fa fa-check"></i><b>12.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="12.6.1" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#basic-use-of-the-calculate_oscillations-function"><i class="fa fa-check"></i><b>12.6.1</b> Basic use of the <code>calculate_oscillations</code> function</a></li>
<li class="chapter" data-level="12.6.2" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#advanced-use-of-the-calculate_oscillations-function"><i class="fa fa-check"></i><b>12.6.2</b> Advanced use of the <code>calculate_oscillations</code> function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="localDiagnostics.html"><a href="localDiagnostics.html"><i class="fa fa-check"></i><b>13</b> Local Diagnostics With Ceteris-paribus Profiles</a><ul>
<li class="chapter" data-level="13.1" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagIntro"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagIntuition"><i class="fa fa-check"></i><b>13.2</b> Intuition</a></li>
<li class="chapter" data-level="13.3" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagMethod"><i class="fa fa-check"></i><b>13.3</b> Method</a><ul>
<li class="chapter" data-level="13.3.1" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagNeighbors"><i class="fa fa-check"></i><b>13.3.1</b> Nearest neighbors</a></li>
<li class="chapter" data-level="13.3.2" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagProfiles"><i class="fa fa-check"></i><b>13.3.2</b> Profiles for neighbors</a></li>
<li class="chapter" data-level="13.3.3" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagLFplot"><i class="fa fa-check"></i><b>13.3.3</b> Local-fidelity plot</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagExample"><i class="fa fa-check"></i><b>13.4</b> Example: Titanic</a></li>
<li class="chapter" data-level="13.5" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagProsCons"><i class="fa fa-check"></i><b>13.5</b> Pros and cons</a></li>
<li class="chapter" data-level="13.6" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagR"><i class="fa fa-check"></i><b>13.6</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html"><i class="fa fa-check"></i><b>14</b> Summary of Instance-level Explainers</a><ul>
<li class="chapter" data-level="14.1" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#number-of-explanatory-variables-in-the-model"><i class="fa fa-check"></i><b>14.1</b> Number of explanatory variables in the model</a><ul>
<li class="chapter" data-level="14.1.1" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#low-to-medium-number-of-explanatory-variables"><i class="fa fa-check"></i><b>14.1.1</b> Low to medium number of explanatory variables</a></li>
<li class="chapter" data-level="14.1.2" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#medium-to-large-number-of-explanatory-variables"><i class="fa fa-check"></i><b>14.1.2</b> Medium to large number of explanatory variables</a></li>
<li class="chapter" data-level="14.1.3" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#very-large-number-of-explanatory-variables"><i class="fa fa-check"></i><b>14.1.3</b> Very large number of explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#correlated-explanatory-variables"><i class="fa fa-check"></i><b>14.2</b> Correlated explanatory variables</a></li>
<li class="chapter" data-level="14.3" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#models-with-interactions"><i class="fa fa-check"></i><b>14.3</b> Models with interactions</a></li>
<li class="chapter" data-level="14.4" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#sparse-explanations"><i class="fa fa-check"></i><b>14.4</b> Sparse explanations</a></li>
<li class="chapter" data-level="14.5" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#additional-uses-of-model-exploration-and-explanation"><i class="fa fa-check"></i><b>14.5</b> Additional uses of model exploration and explanation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-level.html"><a href="model-level.html"><i class="fa fa-check"></i>Model Level</a></li>
<li class="chapter" data-level="15" data-path="modelLevelExploration.html"><a href="modelLevelExploration.html"><i class="fa fa-check"></i><b>15</b> Introduction to Model Level Exploration</a></li>
<li class="chapter" data-level="16" data-path="modelPerformance.html"><a href="modelPerformance.html"><i class="fa fa-check"></i><b>16</b> Model Performance Measures</a><ul>
<li class="chapter" data-level="16.1" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceIntro"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceIntuition"><i class="fa fa-check"></i><b>16.2</b> Intuition</a></li>
<li class="chapter" data-level="16.3" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethod"><i class="fa fa-check"></i><b>16.3</b> Method</a><ul>
<li class="chapter" data-level="16.3.1" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodCont"><i class="fa fa-check"></i><b>16.3.1</b> Continuous dependent variable</a></li>
<li class="chapter" data-level="16.3.2" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodBin"><i class="fa fa-check"></i><b>16.3.2</b> Binary dependent variable</a></li>
<li class="chapter" data-level="16.3.3" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodCateg"><i class="fa fa-check"></i><b>16.3.3</b> Categorical dependent variable</a></li>
<li class="chapter" data-level="16.3.4" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodCount"><i class="fa fa-check"></i><b>16.3.4</b> Count dependent variable</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="modelPerformance.html"><a href="modelPerformance.html#example"><i class="fa fa-check"></i><b>16.4</b> Example</a><ul>
<li class="chapter" data-level="16.4.1" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceApartments"><i class="fa fa-check"></i><b>16.4.1</b> Apartments data</a></li>
<li class="chapter" data-level="16.4.2" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceTitanic"><i class="fa fa-check"></i><b>16.4.2</b> Titanic data</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceProsCons"><i class="fa fa-check"></i><b>16.5</b> Pros and cons</a></li>
<li class="chapter" data-level="16.6" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceR"><i class="fa fa-check"></i><b>16.6</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="featureImportance.html"><a href="featureImportance.html"><i class="fa fa-check"></i><b>17</b> Variable’s Importance</a><ul>
<li class="chapter" data-level="17.1" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceIntro"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceIntuition"><i class="fa fa-check"></i><b>17.2</b> Intuition</a></li>
<li class="chapter" data-level="17.3" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceMethod"><i class="fa fa-check"></i><b>17.3</b> Method</a></li>
<li class="chapter" data-level="17.4" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceTitanic"><i class="fa fa-check"></i><b>17.4</b> Example: Titanic data</a></li>
<li class="chapter" data-level="17.5" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceProsCons"><i class="fa fa-check"></i><b>17.5</b> Pros and cons</a></li>
<li class="chapter" data-level="17.6" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceR"><i class="fa fa-check"></i><b>17.6</b> Code snippets for R</a></li>
<li class="chapter" data-level="17.7" data-path="featureImportance.html"><a href="featureImportance.html#more-models"><i class="fa fa-check"></i><b>17.7</b> More models</a></li>
<li class="chapter" data-level="17.8" data-path="featureImportance.html"><a href="featureImportance.html#level-frequency"><i class="fa fa-check"></i><b>17.8</b> Level frequency</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html"><i class="fa fa-check"></i><b>18</b> Partial Dependency Profiles</a><ul>
<li class="chapter" data-level="18.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPIntro"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPIntuition"><i class="fa fa-check"></i><b>18.2</b> Intuition</a></li>
<li class="chapter" data-level="18.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPMethod"><i class="fa fa-check"></i><b>18.3</b> Method</a><ul>
<li class="chapter" data-level="18.3.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#partial-dependency-profiles"><i class="fa fa-check"></i><b>18.3.1</b> Partial Dependency Profiles</a></li>
<li class="chapter" data-level="18.3.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#clustered-partial-dependency-profiles"><i class="fa fa-check"></i><b>18.3.2</b> Clustered Partial Dependency Profiles</a></li>
<li class="chapter" data-level="18.3.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#grouped-partial-dependency-profiles"><i class="fa fa-check"></i><b>18.3.3</b> Grouped Partial Dependency Profiles</a></li>
<li class="chapter" data-level="18.3.4" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#contrastive-partial-dependency-profiles"><i class="fa fa-check"></i><b>18.3.4</b> Contrastive Partial Dependency profiles</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPExample"><i class="fa fa-check"></i><b>18.4</b> Example: Apartments data</a><ul>
<li class="chapter" data-level="18.4.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#partial-dependency-profiles-1"><i class="fa fa-check"></i><b>18.4.1</b> Partial Dependency Profiles</a></li>
<li class="chapter" data-level="18.4.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#clustered-partial-dependency-profiles-1"><i class="fa fa-check"></i><b>18.4.2</b> Clustered Partial Dependency Profiles</a></li>
<li class="chapter" data-level="18.4.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#grouped-partial-dependency-profiles-1"><i class="fa fa-check"></i><b>18.4.3</b> Grouped Partial Dependency Profiles</a></li>
<li class="chapter" data-level="18.4.4" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#contrastive-partial-dependency-profiles-1"><i class="fa fa-check"></i><b>18.4.4</b> Contrastive Partial Dependency profiles</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPProsCons"><i class="fa fa-check"></i><b>18.5</b> Pros and cons</a></li>
<li class="chapter" data-level="18.6" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPR"><i class="fa fa-check"></i><b>18.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="18.6.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#clustered-partial-dependency-profiles-2"><i class="fa fa-check"></i><b>18.6.1</b> Clustered Partial Dependency profiles</a></li>
<li class="chapter" data-level="18.6.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#grouped-partial-dependency-profiles-2"><i class="fa fa-check"></i><b>18.6.2</b> Grouped Partial Dependency profiles</a></li>
<li class="chapter" data-level="18.6.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#contrastive-partial-dependency-profiles-2"><i class="fa fa-check"></i><b>18.6.3</b> Contrastive Partial Dependency profiles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html"><i class="fa fa-check"></i><b>19</b> Accumulated Local Profiles</a><ul>
<li class="chapter" data-level="19.1" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPIntro"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPIntuition"><i class="fa fa-check"></i><b>19.2</b> Intuition</a></li>
<li class="chapter" data-level="19.3" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPMethod"><i class="fa fa-check"></i><b>19.3</b> Method</a><ul>
<li class="chapter" data-level="19.3.1" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#partial-dependency-profile"><i class="fa fa-check"></i><b>19.3.1</b> Partial Dependency Profile</a></li>
<li class="chapter" data-level="19.3.2" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#conditional-dependency-profile"><i class="fa fa-check"></i><b>19.3.2</b> Conditional Dependency Profile</a></li>
<li class="chapter" data-level="19.3.3" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#accumulated-local-profile"><i class="fa fa-check"></i><b>19.3.3</b> Accumulated Local Profile</a></li>
<li class="chapter" data-level="19.3.4" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#summaryFeatureEffects"><i class="fa fa-check"></i><b>19.3.4</b> Comparison of Explainers for Feature Effects</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#CDPExample"><i class="fa fa-check"></i><b>19.4</b> Example: Apartments data</a></li>
<li class="chapter" data-level="19.5" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPProsCons"><i class="fa fa-check"></i><b>19.5</b> Pros and cons</a></li>
<li class="chapter" data-level="19.6" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPR"><i class="fa fa-check"></i><b>19.6</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html"><i class="fa fa-check"></i><b>20</b> Residual Diagnostic</a><ul>
<li class="chapter" data-level="20.1" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html#introduction-1"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
<li class="chapter" data-level="20.2" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html#intuition"><i class="fa fa-check"></i><b>20.2</b> Intuition</a></li>
<li class="chapter" data-level="20.3" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html#code-snippets-for-r"><i class="fa fa-check"></i><b>20.3</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="use-cases.html"><a href="use-cases.html"><i class="fa fa-check"></i>Use Cases</a></li>
<li class="chapter" data-level="21" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html"><i class="fa fa-check"></i><b>21</b> FIFA 19</a><ul>
<li class="chapter" data-level="21.1" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#introduction-2"><i class="fa fa-check"></i><b>21.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#data-preparation-1"><i class="fa fa-check"></i><b>21.2</b> Data preparation</a></li>
<li class="chapter" data-level="21.3" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#data-understanding"><i class="fa fa-check"></i><b>21.3</b> Data understanding</a></li>
<li class="chapter" data-level="21.4" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#model-assembly-1"><i class="fa fa-check"></i><b>21.4</b> Model assembly</a></li>
<li class="chapter" data-level="21.5" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#model-audit"><i class="fa fa-check"></i><b>21.5</b> Model audit</a></li>
<li class="chapter" data-level="21.6" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#model-understanding-1"><i class="fa fa-check"></i><b>21.6</b> Model understanding</a></li>
<li class="chapter" data-level="21.7" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#instance-understanding"><i class="fa fa-check"></i><b>21.7</b> Instance understanding</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendixes.html"><a href="appendixes.html"><i class="fa fa-check"></i>Appendixes</a></li>
<li class="chapter" data-level="22" data-path="conceptDrift.html"><a href="conceptDrift.html"><i class="fa fa-check"></i><b>22</b> Concept Drift</a><ul>
<li class="chapter" data-level="22.1" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftIntro"><i class="fa fa-check"></i><b>22.1</b> Introduction</a></li>
<li class="chapter" data-level="22.2" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftIntuition"><i class="fa fa-check"></i><b>22.2</b> Intuition</a></li>
<li class="chapter" data-level="22.3" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftMethod"><i class="fa fa-check"></i><b>22.3</b> Method</a></li>
<li class="chapter" data-level="22.4" data-path="conceptDrift.html"><a href="conceptDrift.html#covariate-drift"><i class="fa fa-check"></i><b>22.4</b> Covariate Drift</a></li>
<li class="chapter" data-level="22.5" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftExample"><i class="fa fa-check"></i><b>22.5</b> Example: Titanic data</a></li>
<li class="chapter" data-level="22.6" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftProsCons"><i class="fa fa-check"></i><b>22.6</b> Pros and cons</a></li>
<li class="chapter" data-level="22.7" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftR"><i class="fa fa-check"></i><b>22.7</b> Code snippets for R</a></li>
<li class="chapter" data-level="22.8" data-path="conceptDrift.html"><a href="conceptDrift.html#residual-drift"><i class="fa fa-check"></i><b>22.8</b> Residual Drift</a></li>
<li class="chapter" data-level="22.9" data-path="conceptDrift.html"><a href="conceptDrift.html#code-snippets"><i class="fa fa-check"></i><b>22.9</b> Code snippets</a></li>
<li class="chapter" data-level="22.10" data-path="conceptDrift.html"><a href="conceptDrift.html#model-drift"><i class="fa fa-check"></i><b>22.10</b> Model Drift</a></li>
<li class="chapter" data-level="22.11" data-path="conceptDrift.html"><a href="conceptDrift.html#code-snippets-1"><i class="fa fa-check"></i><b>22.11</b> Code snippets</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="data-set-hr.html"><a href="data-set-hr.html"><i class="fa fa-check"></i><b>23</b> Data Set HR</a><ul>
<li class="chapter" data-level="23.1" data-path="data-set-hr.html"><a href="data-set-hr.html#HFDataset"><i class="fa fa-check"></i><b>23.1</b> Hire or fire</a><ul>
<li class="chapter" data-level="23.1.1" data-path="data-set-hr.html"><a href="data-set-hr.html#exploration-HR"><i class="fa fa-check"></i><b>23.1.1</b> Data exploration</a></li>
<li class="chapter" data-level="23.1.2" data-path="data-set-hr.html"><a href="data-set-hr.html#model-HR-mr"><i class="fa fa-check"></i><b>23.1.2</b> Multinomial logistic regression</a></li>
<li class="chapter" data-level="23.1.3" data-path="data-set-hr.html"><a href="data-set-hr.html#model-HR-rf"><i class="fa fa-check"></i><b>23.1.3</b> Random forest</a></li>
<li class="chapter" data-level="23.1.4" data-path="data-set-hr.html"><a href="data-set-hr.html#predictionsHR"><i class="fa fa-check"></i><b>23.1.4</b> Model predictions</a></li>
<li class="chapter" data-level="23.1.5" data-path="data-set-hr.html"><a href="data-set-hr.html#ListOfModelsHR"><i class="fa fa-check"></i><b>23.1.5</b> List of objects for the <code>HR</code> example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="ccUseCase.html"><a href="ccUseCase.html"><i class="fa fa-check"></i><b>24</b> Use Case: Call Center</a><ul>
<li class="chapter" data-level="24.1" data-path="ccUseCase.html"><a href="ccUseCase.html#introduction-3"><i class="fa fa-check"></i><b>24.1</b> Introduction</a></li>
<li class="chapter" data-level="24.2" data-path="ccUseCase.html"><a href="ccUseCase.html#iteration-1-crisp-modeling"><i class="fa fa-check"></i><b>24.2</b> Iteration 1: Crisp modeling</a><ul>
<li class="chapter" data-level="24.2.1" data-path="ccUseCase.html"><a href="ccUseCase.html#data-preparation-2"><i class="fa fa-check"></i><b>24.2.1</b> Data preparation</a></li>
<li class="chapter" data-level="24.2.2" data-path="ccUseCase.html"><a href="ccUseCase.html#data-exploration-1"><i class="fa fa-check"></i><b>24.2.2</b> Data exploration</a></li>
<li class="chapter" data-level="24.2.3" data-path="ccUseCase.html"><a href="ccUseCase.html#model-assembly-2"><i class="fa fa-check"></i><b>24.2.3</b> Model assembly</a></li>
<li class="chapter" data-level="24.2.4" data-path="ccUseCase.html"><a href="ccUseCase.html#model-understanding-2"><i class="fa fa-check"></i><b>24.2.4</b> Model understanding</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="ccUseCase.html"><a href="ccUseCase.html#iteration-2-fine-tuning"><i class="fa fa-check"></i><b>24.3</b> Iteration 2: Fine tuning</a><ul>
<li class="chapter" data-level="24.3.1" data-path="ccUseCase.html"><a href="ccUseCase.html#analysis-of-residuals"><i class="fa fa-check"></i><b>24.3.1</b> Analysis of residuals</a></li>
<li class="chapter" data-level="24.3.2" data-path="ccUseCase.html"><a href="ccUseCase.html#sensitivity-analysis"><i class="fa fa-check"></i><b>24.3.2</b> Sensitivity analysis</a></li>
<li class="chapter" data-level="24.3.3" data-path="ccUseCase.html"><a href="ccUseCase.html#deeper-analysis-of-individual-observations"><i class="fa fa-check"></i><b>24.3.3</b> Deeper analysis of individual observations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/pbiecek/DALEX" target="blank">DALEX website</a></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Predictive Models: Explore, Explain, and Debug</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="accumulatedLocalProfiles" class="section level1">
<h1><span class="header-section-number">Chapter 19</span> Accumulated Local Profiles</h1>
<div id="ALPIntro" class="section level2">
<h2><span class="header-section-number">19.1</span> Introduction</h2>
<p>One of the largest advantages of the Partial Dependency Profiles is that they are easy to explain, as they are just an average across Ceteris Paribus profiles. But one of the largest disadvantages lies in expectation over marginal distribution which implies that <span class="math inline">\(x^j\)</span> is independent from <span class="math inline">\(x^{-j}\)</span>. In many applications this assumption is violated. For example, for the <code>apartments</code> dataset one can expect that features like <code>surface</code> and <code>number.of.rooms</code> are strongly correlated as apartments with larger number of rooms usually have larger surface. It may makes no sense to consider an apartment with 10 rooms and 20 square meters, so it may be misleading to change <span class="math inline">\(x^{surface}\)</span> independently from <span class="math inline">\(x^{number.of.rooms}\)</span>. In the <code>titanic</code> dataset we shall expect correlation between <code>fare</code> and <code>passenger class</code> as tickets in the 1st class are the most expensive.</p>
<p>There are several attempts to fix this problem. In this chapter we present two of them. Local Dependency Profiles and Accumulated Local Profiles, both introduces in the <span class="citation">(Apley <a href="#ref-ALEPlotRPackage">2018</a>)</span>.
The general idea behind Local Dependency Profiles is to use conditional distribution instead of marginal distribution to accommodate for the dependency between <span class="math inline">\(x^j\)</span> and <span class="math inline">\(x^{-j}\)</span>.
The general idea behind Accumulated Local Profiles is to accumulate local changes in model response affected by single feature <span class="math inline">\(x^j\)</span>.</p>
</div>
<div id="ALPIntuition" class="section level2">
<h2><span class="header-section-number">19.2</span> Intuition</h2>
<p>Intuition behind Partial Dependency profiles and their extensions is presented in Figure <a href="accumulatedLocalProfiles.html#fig:accumulatedLocalEffects">19.1</a>.</p>
<p>First, let’s consider a simple model</p>
<p><span class="math display" id="eq:trickyModel">\[\begin{equation}
f(x_1, x_2) = x_1 * x_2 + x_2
\tag{19.1}
\end{equation}\]</span></p>
<p>Moreover, let’s assume that variables <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> have uniform distribution <span class="math inline">\(x_1, x_2 \sim U[-1,1]\)</span> and are perfectly correlated, i.e. <span class="math inline">\(x_2 = x_1\)</span>.</p>
<p>For this example, suppose that we have dataset with 8 points.</p>
<table>
<thead>
<tr class="header">
<th>i</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x_1\)</span></td>
<td>-1</td>
<td>-0.71</td>
<td>-0.43</td>
<td>-0.14</td>
<td>0.14</td>
<td>0.43</td>
<td>0.71</td>
<td>1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_2\)</span></td>
<td>-1</td>
<td>-0.71</td>
<td>-0.43</td>
<td>-0.14</td>
<td>0.14</td>
<td>0.43</td>
<td>0.71</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Panel A in Figure <a href="accumulatedLocalProfiles.html#fig:accumulatedLocalEffects">19.1</a> shows ceteris paribus profiles calculated for selected 8 points.</p>
<p>Bottom part of the panel B shows Partial Dependency profile. It’s an average from all ceteris paribus profiles (as shown in the top panel).</p>
<p>The idea behind extensions of partial dependency profiles is to use not all profiles, but only parts that are relevant (as shown in the top panels).
Local Dependency Profiles (panel C) are calculated as averages from these selected relevant parts of ceteris paribus profiles.
Accumulated Local Profiles (panel D) are calculated as accumulated changes from these selected relevant parts of ceteris paribus profiles.</p>
<div class="figure" style="text-align: center"><span id="fig:accumulatedLocalEffects"></span>
<img src="figure/CP_ALL.png" alt="(fig:accumulatedLocalEffects) Differences between Partial Dependency, Marginal and Accumulated Local Effects profiles. Panel A) shows Ceteris Paribus Profiles for 8 points. Panel B) shows Partial Dependency profiles, i.e. an average out of these profiles. Panel C shows Marginal profiles, i.e. an average from profiles similar to the point that is being explained. Panel D shows Accumulated Local Effects, i.e. effect curve that takes into account only changes in the Ceteris Paribus Profiles." width="90%" />
<p class="caption">
Figure 19.1: (fig:accumulatedLocalEffects) Differences between Partial Dependency, Marginal and Accumulated Local Effects profiles. Panel A) shows Ceteris Paribus Profiles for 8 points. Panel B) shows Partial Dependency profiles, i.e. an average out of these profiles. Panel C shows Marginal profiles, i.e. an average from profiles similar to the point that is being explained. Panel D shows Accumulated Local Effects, i.e. effect curve that takes into account only changes in the Ceteris Paribus Profiles.
</p>
</div>
<p>For example, for the <code>apartments</code> dataset one can expect that features like <code>surface</code> and <code>number.of.rooms</code> are correlated but we can also imagine that each of these variables affect the apartment price somehow. Partial Dependency Profiles show how the average price changes as a function of surface, keeping all other variables unchanged. Conditional Dependency Profiles show how the average price changes as a function of surface adjusting all other variables to the current value of the surface. Accumulated Local Profiles show how the average price changes as a function of surface adjusting all other variables to the current value of the surface but extracting changes caused by these other features.</p>
</div>
<div id="ALPMethod" class="section level2">
<h2><span class="header-section-number">19.3</span> Method</h2>
<div id="partial-dependency-profile" class="section level3">
<h3><span class="header-section-number">19.3.1</span> Partial Dependency Profile</h3>
<p>Partial Dependency Profile is defined as an expected value from Ceteris Paribus Profiles.</p>
<p><span class="math display" id="eq:PDPdef">\[\begin{equation}
g^{PD}_i(z) = E_{X_{-i}}[ f(x|^i = z, x^{-i}) ].
\tag{19.2}
\end{equation}\]</span></p>
<p>And can be estimated as average from CP profiles.</p>
<p><span class="math display" id="eq:PDPest">\[\begin{equation}
\hat g^{PD}_i(z) = \frac{1}{n} \sum_{j=1}^{n} f(x|^i = z, x_j^{-i}).
\tag{19.3}
\end{equation}\]</span></p>
<p>As it is shown in Figure <a href="accumulatedLocalProfiles.html#fig:accumulatedLocalEffects">19.1</a> panel B, PD profiles are averages from all CP profiles.</p>
</div>
<div id="conditional-dependency-profile" class="section level3">
<h3><span class="header-section-number">19.3.2</span> Conditional Dependency Profile</h3>
<p>As it was said, if there is some dependency between <span class="math inline">\(X_i\)</span> and <span class="math inline">\(X_{-i}\)</span> it makes no sense to average CP profiles over marginal <span class="math inline">\(X_{-i}\)</span> bacuse ,,all other things kep unchanges’’ is not a reliable approach.
Instead, an intuitive approach would to use a conditional distribution <span class="math inline">\(X_{-i}|X_i=x_i\)</span> (which is of course unknown).</p>
<p>Conditional Dependency Profile for a model <span class="math inline">\(f\)</span> and a variable <span class="math inline">\(x^j\)</span> is defined as</p>
<p><span class="math display" id="eq:CDPdef">\[\begin{equation}
g^{CD}_{f, i}(z) = E_{X_{-i}|X_i=x_i}[ f(x|^i = z, x^{-i}) ].
\tag{19.4}
\end{equation}\]</span></p>
<p>So it’s an expected value over <strong>conditional</strong> distribution <span class="math inline">\((X^j,X^{-j})|X^j=z\)</span>.</p>
<p>For example, let <span class="math inline">\(f(x_1, x_2) = x_1 + x_2\)</span> and distribution of <span class="math inline">\((x_1, x_2)\)</span> is given by <span class="math inline">\(x_1 \sim U[0,1]\)</span> and <span class="math inline">\(x_2=x_1\)</span>. In this case <span class="math inline">\(g^{CD}_{f, 1}(z) = 2*z\)</span>.</p>
<p>The natural estimator for Conditional Dependency Profiles introduced in <span class="citation">(Apley <a href="#ref-ALEPlotRPackage">2018</a>)</span> is</p>
<p><span class="math display" id="eq:CDPest">\[\begin{equation}
\hat g^{CD}_i(z) = \frac{1}{|N_i|} \sum_{j\in N_i} f(x|^i = z, x_j^{-i}). 
\tag{19.5}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(N_i\)</span> is the set of observations with <span class="math inline">\(x_i\)</span> close to <span class="math inline">\(z\)</span>. This set will be used to estimate distribution <span class="math inline">\(X_{-i}|X_i=x_i\)</span>.</p>
<p>In Figure <a href="accumulatedLocalProfiles.html#fig:accumulatedLocalEffects">19.1</a> panel C the range of variable <span class="math inline">\(x_i\)</span> is divided into 4 separable intervals. The set <span class="math inline">\(N_i\)</span> contains all observations that fall into the same interval as observation <span class="math inline">\(x_i\)</span>. The final CD profile is an average from closest pieces of CP profiles.</p>
<p>Note that in general the <span class="math inline">\(\hat g^{CD}_i(z)\)</span> is neither smooth, nor continuous in boundaries between <span class="math inline">\(N_i\)</span> subsets. Thus here we propose another smooth estimator for <span class="math inline">\(g_i^{CD}\)</span></p>
<p><span class="math display" id="eq:CDPest2">\[\begin{equation}
\tilde g^{CD}_i(z) = \frac{1}{\sum_k w_{k}(z)} \sum_{j = 1}^n w_j(z) f(x|^i = z, x_j^{-i}) . 
\tag{19.6}
\end{equation}\]</span></p>
<p>Weights <span class="math inline">\(w_j(z)\)</span> correspond to the distance between <span class="math inline">\(z\)</span> and observation <span class="math inline">\(x_j\)</span>. For categorical variables we may use simple indicator function <span class="math inline">\(w_j(z) := 1_{z == x^i_j}\)</span> while for continuous variables we may use Gaussian kernel
<span class="math display">\[
w_j(z) = \phi(z - x_j^i; 0; s),
\]</span>
where <span class="math inline">\(s\)</span> is a smoothing factor.</p>
</div>
<div id="accumulated-local-profile" class="section level3">
<h3><span class="header-section-number">19.3.3</span> Accumulated Local Profile</h3>
<p>Accumulated Local Profile for a model <span class="math inline">\(f\)</span> and a variable <span class="math inline">\(x^j\)</span> is defined as</p>
<p><span class="math display" id="eq:ALEdef">\[\begin{equation}
g^{ALE}_{f, j}(z) = \int_{z_0}^z E\left[\frac{\partial f(X^j, X^{-j})}{\partial x_j}|X^j = v\right] dv + c,
\tag{19.7}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(z_0\)</span> if the lower boundary of <span class="math inline">\(x^j\)</span>. The profile <span class="math inline">\(g^{ALE}_{f, j}(z)\)</span> is calculated up to some constant <span class="math inline">\(c\)</span>. Usually the constant <span class="math inline">\(c\)</span> is selected to set average <span class="math inline">\(g^{ALE}_{f, j}\)</span> equal to 0 or an average of <span class="math inline">\(f(x)\)</span>.</p>
<p>The equation may be a bit complex, but the intuition is not that complicated. Instead of averaging Ceteris Paribus profiles we just look locally how quickly local CP profiles are changing. And ALE profile is reconstructed from such local partial changes as cumulative derivative over changes.</p>
<p>So it’s a cumulated expected change of the model response along where the expected values are calculated over <strong>conditional</strong> distribution <span class="math inline">\((X^j,X^{-j})|X^j=z\)</span>.</p>
<p>For example, let <span class="math inline">\(f(x_1, x_2) = x_1 + x_2\)</span> and distribution of <span class="math inline">\((x_1, x_2)\)</span> is given by <span class="math inline">\(x_1 \sim U[0,1]\)</span> and <span class="math inline">\(x_2=x_1\)</span>. In this case <span class="math inline">\(g^{ALE}_{f, 1}(z) = z\)</span>.</p>
<p>The natural estimator for Accumulated Local Profiles introduced in <span class="citation">(Apley <a href="#ref-ALEPlotRPackage">2018</a>)</span> is</p>
<p><span class="math display" id="eq:ALEPest">\[\begin{equation}
\hat g^{ALE}_i(z) = \sum_{k=1}^{k_i(z)} \frac{1}{|N_i(k)|} \sum_{j \in N_i} \left[ f(x|^i = z_k) - f(x|^i = z_{k-1}) \right] + c
\tag{19.8}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(k_i(z)\)</span> is the index of interval with point <span class="math inline">\(z\)</span>, <span class="math inline">\(N_i\)</span> is the set of observations with <span class="math inline">\(x_i\)</span> in this interval. The difference <span class="math inline">\(f(x|^i = z_k) - f(x|^i = z_{k-1})\)</span> correspond to the difference of CP profiles in interval <span class="math inline">\(k\)</span>, and this difference is averaged and accumulated.</p>
<p>In Figure <a href="accumulatedLocalProfiles.html#fig:accumulatedLocalEffects">19.1</a> panel D the range of variable <span class="math inline">\(x_i\)</span> is divided into 4 separable intervals. The set <span class="math inline">\(N_i\)</span> contains all observations that fall into the same interval as observation <span class="math inline">\(x_i\)</span>. The final ALE profile is constructed from accumulated differences of local CP profiles.</p>
<p>Note that in general the <span class="math inline">\(\hat g^{CD}_i(z)\)</span> is not smooth in boundaries between <span class="math inline">\(N_i\)</span> subsets. Thus here we propose another smooth estimator for <span class="math inline">\(g_i^{ALE}\)</span></p>
<p><span class="math display" id="eq:ALEPest2">\[\begin{equation}
\tilde g^{ALE}_i(z) = \sum_{k \in {z_0, ..., z}} \frac{1}{\sum_{j} w_{j}(k)} \sum_{j=1}^n w_{j}(k) \left[f(x|^i = z_k) - f(x|^i = z_k - \Delta)\right] + c
\tag{19.9}
\end{equation}\]</span></p>
<p>The set <span class="math inline">\({z_0, ..., z}\)</span> is a uniform grid of points between <span class="math inline">\(z_0\)</span> and <span class="math inline">\(z\)</span> with the step <span class="math inline">\(\Delta\)</span>.
Weights <span class="math inline">\(w_i(k)\)</span> correspond to the distance between point <span class="math inline">\(k\)</span> and observation <span class="math inline">\(x_i\)</span>. For categorical variables we may use simple indicator function <span class="math inline">\(w_j(k) := 1_{k == x_j^i}\)</span> while for continuous variables we may use Gaussian kernel
<span class="math display">\[
w_j(k) = \phi(k - x_j^i; 0; s),
\]</span>
where <span class="math inline">\(s\)</span> is a smoothing factor.</p>
</div>
<div id="summaryFeatureEffects" class="section level3">
<h3><span class="header-section-number">19.3.4</span> Comparison of Explainers for Feature Effects</h3>
<p>In previous sections we introduced different was to calculate model level explainers for feature effects.
A natural question is how these approaches are different and which one should we choose.</p>
<p>An example that illustrate differences between these approaches is presented in Figure <a href="accumulatedLocalProfiles.html#fig:accumulatedLocalEffects">19.1</a>.
Here we have a model <span class="math inline">\(f(x_1, x_2) = x_1*x_2 + x_2\)</span> and what is important features are correlated <span class="math inline">\(x_1 \sim U[-1,1]\)</span> and <span class="math inline">\(x_2 = x_1\)</span>.</p>
<p>Panel A) shows Ceteris Paribus for 8 data points, the feature <span class="math inline">\(x_1\)</span> is on the OX axis while <span class="math inline">\(f\)</span> is on the OY.
Panel B) shows Partial Dependency Profiles calculated as an average from CP profiles.</p>
<p><span class="math display">\[
g^{PD}_{f,1}(z) = E[z*x^2 + x^2] = 0
\]</span></p>
<p>Panel C) shows Conditional Dependency Profiles calculated as an average from conditional CP profiles. In the figure the conditioning is calculated in four bins, but knowing the formula for <span class="math inline">\(f\)</span> we can calculated it directly as.</p>
<p><span class="math display">\[
g^{CD}_{f,1}(z) = E[X^1*X^2 + X^2 | X^1 = z] = z^2+z
\]</span></p>
<p>Panel D) shows Accumulated Local Effects calculated as accumulated changes in conditional CP profiles. In the figure the conditioning is calculated in four bins, but knowing the formula for <span class="math inline">\(f\)</span> we can calculated it directly as.</p>
<p><span class="math display">\[
g^{AL}_{f,1}(z) = \int_{z_0}^z E\left[\frac{\partial (X^1*X^2 + X^2)}{\partial x_1}|X^1 = v\right] dv  = \int_{z_0}^z E\left[X^2|X^1 = v\right] dv  = \frac{z^2 -1 }{2},
\]</span></p>
</div>
</div>
<div id="CDPExample" class="section level2">
<h2><span class="header-section-number">19.4</span> Example: Apartments data</h2>
<p>In this section we will use random forest model <code>apartments_rf_v5</code> trained on <code>apartments</code> data in order to predict the price per square meter of an apartment. See section <a href="dataSetsIntro.html#model-Apartments-rf">5.2.3</a> for more details.
This example is focused on two dependent variables <code>surface</code> and <code>no.rooms</code>. What is more important is that these two variables are correlated.</p>
<p>Figure <a href="accumulatedLocalProfiles.html#fig:featureEffectsApartment">19.2</a> shows Partial Dependency, Conditional Dependency and Accumulated Local profiles for the random forest model.</p>
<p>Number of rooms and surface are two correlated variables, moreover both have some effect on the price per square meter. As we see profiles calculated with different methods are different. One we take into account the correlation between variables, the feature effects are less steep.</p>
<div class="figure" style="text-align: center"><span id="fig:featureEffectsApartment"></span>
<img src="PM_VEE_files/figure-html/featureEffectsApartment-1.png" alt="Partial Dependency, Conditional Dependency and Accumulated Local profiles for the random forest model and apartments data." width="75%" />
<p class="caption">
Figure 19.2: Partial Dependency, Conditional Dependency and Accumulated Local profiles for the random forest model and apartments data.
</p>
</div>
</div>
<div id="ALPProsCons" class="section level2">
<h2><span class="header-section-number">19.5</span> Pros and cons</h2>
<p>In this chapter we introduced tools for extraction of the information between model response and individual model inputs. These tools are useful to summarize how ,,in general’’ model responds to the input of interest. All presented approaches are based on Ceteris Paribus Profiles introduced in Chapter <a href="ceterisParibus.html#ceterisParibus">11</a> but they differ in a way how individual profiles are merged into a global model response.</p>
<p>We use the term ,,feature effect’’ to refer to global model response as a function of single or small number of model features.
Methods presented in this chapter are useful for extraction information of feature effect, i.e. how a feature is linked with model response. There are many possible applications of such methods, for example:</p>
<ul>
<li>Feature effect may be used for feature engineering. The crude approach to modeling is to fit some elastic model on raw data and then use feature effects to understand the relation between a raw feature and model output and then to transform model input to better fit the model output. Such procedure is called surrogate training. In this procedure an elastic model is trained to learn about link between a feature and the target. Then a new feature is created in a way to better utilized the feature in a simpler model <span class="citation">(Gosiewska et al. <a href="#ref-SAFE-arxiv">2019</a>)</span>. In the next chapters we will show how feature effects can be used to transform a continuous variable in to a categorical one in order to improve the model behavior.</li>
<li>Feature effect may be used for model validation. Understanding how a model utilizes a feature may be used as a validation of a model against domain knowledge. For example if we expect monotonic relation or linear relation then such expectations can be verified. Also if we expect smooth relation between model and its inputs then the smoothness can be visually examined. In the next chapters we will show how feature effects can be used to warn a model developer that model is unstable and should be regularized.</li>
<li>In new domains an understanding of a link between model output and the feature of interest may increase our domain knowledge. It may give quick insights related to the strength or character of the relation between a feature of interest and the model output.</li>
<li>The comparison of feature effects between different models may help to understand how different models handle particular features. In the next chapters we will show how feature effects can be used learn limitations of particular classes of models.</li>
</ul>
</div>
<div id="ALPR" class="section level2">
<h2><span class="header-section-number">19.6</span> Code snippets for R</h2>
<p>Here we show partial dependency profiles calculated with <code>ingredients</code> package <span class="citation">(Biecek et al. <a href="#ref-ingredientsRPackage">2019</a>)</span>. You will also find similar functions in the <code>ALEPlots</code> package <span class="citation">(Apley <a href="#ref-ALEPlotRPackage">2018</a>)</span>.</p>
<p>Partial dependency profiles can be calculated with the function <code>ingredients::partial_dependency</code>.
Conditional dependency profiles can be calculated with the function <code>ingredients::conditional_dependency</code>.
Accumulated local profiles can be calculated with the function <code>ingredients::accumulated_dependency</code>.</p>
<p>In all these cases the only required argument is the explainer and by default profiles are calculated for all variables.</p>
<p>Below we use <code>variables</code> argument to limit list of variables for which profiles are calculated. Here we need profiles only for the <code>no.rooms</code> and <code>surface</code> variables.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1">explain_apartments_rf &lt;-<span class="st"> </span><span class="kw">explain</span>(model_apartments_rf, </a>
<a class="sourceLine" id="cb156-2" data-line-number="2">                                 <span class="dt">data =</span> apartments,</a>
<a class="sourceLine" id="cb156-3" data-line-number="3">                                 <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb156-4" data-line-number="4"></a>
<a class="sourceLine" id="cb156-5" data-line-number="5">pd_rf &lt;-<span class="st"> </span><span class="kw">partial_dependency</span>(explain_apartments_rf, <span class="dt">variables =</span> <span class="kw">c</span>(<span class="st">&quot;no.rooms&quot;</span>, <span class="st">&quot;surface&quot;</span>))</a>
<a class="sourceLine" id="cb156-6" data-line-number="6"></a>
<a class="sourceLine" id="cb156-7" data-line-number="7"><span class="kw">plot</span>(pd_rf) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Partial dependency&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb156-8" data-line-number="8"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Surface and number of rooms&quot;</span>, <span class="st">&quot;Partial dependency for random forest model&quot;</span>) </a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:aleExample1"></span>
<img src="PM_VEE_files/figure-html/aleExample1-1.png" alt="Partial Dependency profile for surface and number of rooms" width="80%" />
<p class="caption">
Figure 19.3: Partial Dependency profile for surface and number of rooms
</p>
</div>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1">ac_rf &lt;-<span class="st"> </span><span class="kw">accumulated_dependency</span>(explain_apartments_rf, <span class="dt">variables =</span> <span class="kw">c</span>(<span class="st">&quot;no.rooms&quot;</span>, <span class="st">&quot;surface&quot;</span>))</a>
<a class="sourceLine" id="cb157-2" data-line-number="2"></a>
<a class="sourceLine" id="cb157-3" data-line-number="3"><span class="kw">plot</span>(ac_rf) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Accumulated dependency&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb157-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Surface and number of rooms&quot;</span>, <span class="st">&quot;Accumulated dependency for random forest model&quot;</span>) </a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:aleExample2"></span>
<img src="PM_VEE_files/figure-html/aleExample2-1.png" alt="Accumulated dependency profile for surface and number of rooms" width="80%" />
<p class="caption">
Figure 19.4: Accumulated dependency profile for surface and number of rooms
</p>
</div>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1">pd_rf &lt;-<span class="st"> </span><span class="kw">conditional_dependency</span>(explain_apartments_rf, <span class="dt">variables =</span> <span class="kw">c</span>(<span class="st">&quot;no.rooms&quot;</span>, <span class="st">&quot;surface&quot;</span>))</a>
<a class="sourceLine" id="cb158-2" data-line-number="2"></a>
<a class="sourceLine" id="cb158-3" data-line-number="3"><span class="kw">plot</span>(pd_rf) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Conditional dependency&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb158-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Surface and number of rooms&quot;</span>, <span class="st">&quot;Conditional dependency for random forest model&quot;</span>) </a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:aleExample3"></span>
<img src="PM_VEE_files/figure-html/aleExample3-1.png" alt="Conditional dependency profile for surface and number of rooms" width="80%" />
<p class="caption">
Figure 19.5: Conditional dependency profile for surface and number of rooms
</p>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-ALEPlotRPackage">
<p>Apley, Dan. 2018. <em>ALEPlot: Accumulated Local Effects (Ale) Plots and Partial Dependence (Pd) Plots</em>. <a href="https://CRAN.R-project.org/package=ALEPlot">https://CRAN.R-project.org/package=ALEPlot</a>.</p>
</div>
<div id="ref-ingredientsRPackage">
<p>Biecek, Przemyslaw, Hubert Baniecki, Adam Izdebski, and Katarzyna Pekala. 2019. <em>Ingredients: Effects and Importances of Model Ingredients</em>.</p>
</div>
<div id="ref-SAFE-arxiv">
<p>Gosiewska, Alicja, Aleksandra Gacek, Piotr Lubon, and Przemyslaw Biecek. 2019. “SAFE Ml: Surrogate Assisted Feature Extraction for Model Learning.” <a href="https://arxiv.org/abs/1902.11035">https://arxiv.org/abs/1902.11035</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="partialDependenceProfiles.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="residualDiagnostic.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["PM_VEE.pdf", "PM_VEE.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
