<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Ceteris-paribus Profiles and What-If Analysis | Predictive Models: Explore, Explain, and Debug</title>
  <meta name="description" content="This book introduces key concepts for exploration, explanation and visualization of complex predictive models." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Ceteris-paribus Profiles and What-If Analysis | Predictive Models: Explore, Explain, and Debug" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book introduces key concepts for exploration, explanation and visualization of complex predictive models." />
  <meta name="github-repo" content="pbiecek/PM_VEE" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Ceteris-paribus Profiles and What-If Analysis | Predictive Models: Explore, Explain, and Debug" />
  
  <meta name="twitter:description" content="This book introduces key concepts for exploration, explanation and visualization of complex predictive models." />
  

<meta name="author" content="Przemyslaw Biecek and Tomasz Burzykowski" />


<meta name="date" content="2019-12-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="InstanceLevelExploration.html"/>
<link rel="next" href="ceterisParibusOscillations.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-5650686-15', 'https://pbiecek.github.io/PM_VEE/', {
  'anonymizeIp': true
  , 'storage': 'none'
  , 'clientId': window.localStorage.getItem('ga_clientId')
});
ga(function(tracker) {
  window.localStorage.setItem('ga_clientId', tracker.get('clientId'));
});
ga('send', 'pageview');
</script>
<style>
.figure {
   padding:40px 0px;
}
</style>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Predictive Models:<br/> Visualisation, Exploration and Explanation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#notes-to-readers"><i class="fa fa-check"></i><b>1.1</b> Notes to readers</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-aim-of-the-book"><i class="fa fa-check"></i><b>1.2</b> The aim of the book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#three-single-laws"><i class="fa fa-check"></i><b>1.3</b> A bit of philosophy: three laws of model explanation</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#terminology"><i class="fa fa-check"></i><b>1.4</b> Terminology</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#glass-box-models-vs.black-box-models"><i class="fa fa-check"></i><b>1.5</b> Glass-box models vs. black-box models</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#model-visualization-exploration-and-explanation"><i class="fa fa-check"></i><b>1.6</b> Model visualization, exploration, and explanation</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#model-agnostic-vs.model-specific-approach"><i class="fa fa-check"></i><b>1.7</b> Model-agnostic vs. model-specific approach</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#notation"><i class="fa fa-check"></i><b>1.8</b> Notation</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#bookstructure"><i class="fa fa-check"></i><b>1.9</b> The structure of the book</a></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#thanksto"><i class="fa fa-check"></i><b>1.10</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html"><i class="fa fa-check"></i><b>2</b> Do-it-yourself With R</a><ul>
<li class="chapter" data-level="2.1" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#what-to-install"><i class="fa fa-check"></i><b>2.1</b> What to install?</a></li>
<li class="chapter" data-level="2.2" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#how-to-work-with-dalex"><i class="fa fa-check"></i><b>2.2</b> How to work with <code>DALEX</code>?</a></li>
<li class="chapter" data-level="2.3" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#how-to-work-with-archivist"><i class="fa fa-check"></i><b>2.3</b> How to work with <code>archivist</code>?</a></li>
<li class="chapter" data-level="2.4" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#Packages"><i class="fa fa-check"></i><b>2.4</b> DrWhy Packages</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="doItYourselfWithPython.html"><a href="doItYourselfWithPython.html"><i class="fa fa-check"></i><b>3</b> Do-it-yourself With Python</a></li>
<li class="chapter" data-level="4" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html"><i class="fa fa-check"></i><b>4</b> Model Development</a><ul>
<li class="chapter" data-level="4.1" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#MDPIntro"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#the-process"><i class="fa fa-check"></i><b>4.2</b> The Process</a></li>
<li class="chapter" data-level="4.3" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#data-preparation"><i class="fa fa-check"></i><b>4.3</b> Data preparation</a></li>
<li class="chapter" data-level="4.4" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#data-exploration"><i class="fa fa-check"></i><b>4.4</b> Data exploration</a></li>
<li class="chapter" data-level="4.5" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#model-assembly"><i class="fa fa-check"></i><b>4.5</b> Model assembly</a></li>
<li class="chapter" data-level="4.6" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#model-understanding"><i class="fa fa-check"></i><b>4.6</b> Model understanding</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html"><i class="fa fa-check"></i><b>5</b> Data sets and models</a><ul>
<li class="chapter" data-level="5.1" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#TitanicDataset"><i class="fa fa-check"></i><b>5.1</b> Sinking of the RMS Titanic</a><ul>
<li class="chapter" data-level="5.1.1" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#exploration-titanic"><i class="fa fa-check"></i><b>5.1.1</b> Data exploration</a></li>
<li class="chapter" data-level="5.1.2" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-titanic-lmr"><i class="fa fa-check"></i><b>5.1.2</b> Logistic regression</a></li>
<li class="chapter" data-level="5.1.3" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-titanic-rf"><i class="fa fa-check"></i><b>5.1.3</b> Random forest</a></li>
<li class="chapter" data-level="5.1.4" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-titanic-gbm"><i class="fa fa-check"></i><b>5.1.4</b> Gradient boosting</a></li>
<li class="chapter" data-level="5.1.5" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#predictions-titanic"><i class="fa fa-check"></i><b>5.1.5</b> Model predictions</a></li>
<li class="chapter" data-level="5.1.6" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ExplainersTitanicRCode"><i class="fa fa-check"></i><b>5.1.6</b> Explainers</a></li>
<li class="chapter" data-level="5.1.7" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ListOfModelsTitanic"><i class="fa fa-check"></i><b>5.1.7</b> List of objects for the <code>titanic</code> example</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ApartmentDataset"><i class="fa fa-check"></i><b>5.2</b> Apartment prices</a><ul>
<li class="chapter" data-level="5.2.1" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#exploration-apartments"><i class="fa fa-check"></i><b>5.2.1</b> Data exploration</a></li>
<li class="chapter" data-level="5.2.2" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-Apartments-lr"><i class="fa fa-check"></i><b>5.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="5.2.3" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-Apartments-rf"><i class="fa fa-check"></i><b>5.2.3</b> Random forest</a></li>
<li class="chapter" data-level="5.2.4" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#predictionsApartments"><i class="fa fa-check"></i><b>5.2.4</b> Model predictions</a></li>
<li class="chapter" data-level="5.2.5" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ExplainersApartmentsRCode"><i class="fa fa-check"></i><b>5.2.5</b> Explainers</a></li>
<li class="chapter" data-level="5.2.6" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ListOfModelsApartments"><i class="fa fa-check"></i><b>5.2.6</b> List of objects for the <code>apartments</code> example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="InstanceLevelExploration.html"><a href="InstanceLevelExploration.html"><i class="fa fa-check"></i><b>6</b> Instance-level exploration</a></li>
<li class="chapter" data-level="7" data-path="ceterisParibus.html"><a href="ceterisParibus.html"><i class="fa fa-check"></i><b>7</b> Ceteris-paribus Profiles and What-If Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPIntro"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPIntuition"><i class="fa fa-check"></i><b>7.2</b> Intuition</a></li>
<li class="chapter" data-level="7.3" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPMethod"><i class="fa fa-check"></i><b>7.3</b> Method</a></li>
<li class="chapter" data-level="7.4" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPExample"><i class="fa fa-check"></i><b>7.4</b> Example: Titanic</a></li>
<li class="chapter" data-level="7.5" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPProsCons"><i class="fa fa-check"></i><b>7.5</b> Pros and cons</a></li>
<li class="chapter" data-level="7.6" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPR"><i class="fa fa-check"></i><b>7.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="7.6.1" data-path="ceterisParibus.html"><a href="ceterisParibus.html#basic-use-of-the-ceteris_paribus-function"><i class="fa fa-check"></i><b>7.6.1</b> Basic use of the <code>ceteris_paribus</code> function</a></li>
<li class="chapter" data-level="7.6.2" data-path="ceterisParibus.html"><a href="ceterisParibus.html#advanced-use-of-the-ceteris_paribus-function"><i class="fa fa-check"></i><b>7.6.2</b> Advanced use of the <code>ceteris_paribus</code> function</a></li>
<li class="chapter" data-level="7.6.3" data-path="ceterisParibus.html"><a href="ceterisParibus.html#champion-challenger-analysis"><i class="fa fa-check"></i><b>7.6.3</b> Champion-challenger analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html"><i class="fa fa-check"></i><b>8</b> Ceteris-paribus Oscillations and Local Variable-importance</a><ul>
<li class="chapter" data-level="8.1" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscIntro"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscIntuition"><i class="fa fa-check"></i><b>8.2</b> Intuition</a></li>
<li class="chapter" data-level="8.3" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscMethod"><i class="fa fa-check"></i><b>8.3</b> Method</a></li>
<li class="chapter" data-level="8.4" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscExample"><i class="fa fa-check"></i><b>8.4</b> Example: Titanic</a></li>
<li class="chapter" data-level="8.5" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscProsCons"><i class="fa fa-check"></i><b>8.5</b> Pros and cons</a></li>
<li class="chapter" data-level="8.6" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscR"><i class="fa fa-check"></i><b>8.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="8.6.1" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#basic-use-of-the-calculate_oscillations-function"><i class="fa fa-check"></i><b>8.6.1</b> Basic use of the <code>calculate_oscillations</code> function</a></li>
<li class="chapter" data-level="8.6.2" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#advanced-use-of-the-calculate_oscillations-function"><i class="fa fa-check"></i><b>8.6.2</b> Advanced use of the <code>calculate_oscillations</code> function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="localDiagnostics.html"><a href="localDiagnostics.html"><i class="fa fa-check"></i><b>9</b> Local Diagnostics With Ceteris-paribus Profiles</a><ul>
<li class="chapter" data-level="9.1" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagIntro"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagIntuition"><i class="fa fa-check"></i><b>9.2</b> Intuition</a></li>
<li class="chapter" data-level="9.3" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagMethod"><i class="fa fa-check"></i><b>9.3</b> Method</a><ul>
<li class="chapter" data-level="9.3.1" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagNeighbors"><i class="fa fa-check"></i><b>9.3.1</b> Nearest neighbors</a></li>
<li class="chapter" data-level="9.3.2" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagProfiles"><i class="fa fa-check"></i><b>9.3.2</b> Profiles for neighbors</a></li>
<li class="chapter" data-level="9.3.3" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagLFplot"><i class="fa fa-check"></i><b>9.3.3</b> Local-fidelity plot</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagExample"><i class="fa fa-check"></i><b>9.4</b> Example: Titanic</a></li>
<li class="chapter" data-level="9.5" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagProsCons"><i class="fa fa-check"></i><b>9.5</b> Pros and cons</a></li>
<li class="chapter" data-level="9.6" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagR"><i class="fa fa-check"></i><b>9.6</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="breakDown.html"><a href="breakDown.html"><i class="fa fa-check"></i><b>10</b> Break-down Plots for Additive Variable Attributions</a><ul>
<li class="chapter" data-level="10.1" data-path="breakDown.html"><a href="breakDown.html#BDIntuition"><i class="fa fa-check"></i><b>10.1</b> Intuition</a></li>
<li class="chapter" data-level="10.2" data-path="breakDown.html"><a href="breakDown.html#BDMethod"><i class="fa fa-check"></i><b>10.2</b> Method</a><ul>
<li class="chapter" data-level="10.2.1" data-path="breakDown.html"><a href="breakDown.html#break-down-for-linear-models"><i class="fa fa-check"></i><b>10.2.1</b> Break-down for linear models</a></li>
<li class="chapter" data-level="10.2.2" data-path="breakDown.html"><a href="breakDown.html#break-down-for-general-case"><i class="fa fa-check"></i><b>10.2.2</b> Break-down for general case</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="breakDown.html"><a href="breakDown.html#BDExample"><i class="fa fa-check"></i><b>10.3</b> Example: Titanic data</a></li>
<li class="chapter" data-level="10.4" data-path="breakDown.html"><a href="breakDown.html#BDProsCons"><i class="fa fa-check"></i><b>10.4</b> Pros and cons</a></li>
<li class="chapter" data-level="10.5" data-path="breakDown.html"><a href="breakDown.html#BDR"><i class="fa fa-check"></i><b>10.5</b> Code snippets for R</a><ul>
<li class="chapter" data-level="10.5.1" data-path="breakDown.html"><a href="breakDown.html#basic-use-of-the-break_down-function"><i class="fa fa-check"></i><b>10.5.1</b> Basic use of the <code>break_down()</code> function</a></li>
<li class="chapter" data-level="10.5.2" data-path="breakDown.html"><a href="breakDown.html#advanced-use-of-the-break_down-function"><i class="fa fa-check"></i><b>10.5.2</b> Advanced use of the <code>break_down()</code> function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="iBreakDown.html"><a href="iBreakDown.html"><i class="fa fa-check"></i><b>11</b> Break-down Plots for Models with Interactions (iBreak-down Plots)</a><ul>
<li class="chapter" data-level="11.1" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDIntuition"><i class="fa fa-check"></i><b>11.1</b> Intuition</a></li>
<li class="chapter" data-level="11.2" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDMethod"><i class="fa fa-check"></i><b>11.2</b> Method</a></li>
<li class="chapter" data-level="11.3" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDExample"><i class="fa fa-check"></i><b>11.3</b> Example: Titanic data</a></li>
<li class="chapter" data-level="11.4" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDProsCons"><i class="fa fa-check"></i><b>11.4</b> Pros and cons</a></li>
<li class="chapter" data-level="11.5" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDRcode"><i class="fa fa-check"></i><b>11.5</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="shapley.html"><a href="shapley.html"><i class="fa fa-check"></i><b>12</b> Shapley Additive Explanations (SHAP) and Average Variable Attributions</a><ul>
<li class="chapter" data-level="12.1" data-path="shapley.html"><a href="shapley.html#SHAPIntuition"><i class="fa fa-check"></i><b>12.1</b> Intuition</a></li>
<li class="chapter" data-level="12.2" data-path="shapley.html"><a href="shapley.html#SHAPMethod"><i class="fa fa-check"></i><b>12.2</b> Method</a></li>
<li class="chapter" data-level="12.3" data-path="shapley.html"><a href="shapley.html#SHAPExample"><i class="fa fa-check"></i><b>12.3</b> Example: Titanic data</a></li>
<li class="chapter" data-level="12.4" data-path="shapley.html"><a href="shapley.html#SHAProsCons"><i class="fa fa-check"></i><b>12.4</b> Pros and cons</a></li>
<li class="chapter" data-level="12.5" data-path="shapley.html"><a href="shapley.html#SHAPRcode"><i class="fa fa-check"></i><b>12.5</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="LIME.html"><a href="LIME.html"><i class="fa fa-check"></i><b>13</b> Local Interpretable Model-agnostic Explanations (LIME)</a><ul>
<li class="chapter" data-level="13.1" data-path="LIME.html"><a href="LIME.html#LIMEIntroduction"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="LIME.html"><a href="LIME.html#LIMEIntuition"><i class="fa fa-check"></i><b>13.2</b> Intuition</a></li>
<li class="chapter" data-level="13.3" data-path="LIME.html"><a href="LIME.html#LIMEMethod"><i class="fa fa-check"></i><b>13.3</b> Method</a><ul>
<li class="chapter" data-level="13.3.1" data-path="LIME.html"><a href="LIME.html#interpretable-data-representation"><i class="fa fa-check"></i><b>13.3.1</b> Interpretable data representation</a></li>
<li class="chapter" data-level="13.3.2" data-path="LIME.html"><a href="LIME.html#sampling-around-the-instance-of-interest"><i class="fa fa-check"></i><b>13.3.2</b> Sampling around the instance of interest</a></li>
<li class="chapter" data-level="13.3.3" data-path="LIME.html"><a href="LIME.html#developing-the-white-box-model"><i class="fa fa-check"></i><b>13.3.3</b> Developing the white-box model</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="LIME.html"><a href="LIME.html#LIMEExample"><i class="fa fa-check"></i><b>13.4</b> Example: Titanic data</a></li>
<li class="chapter" data-level="13.5" data-path="LIME.html"><a href="LIME.html#LIMEProsCons"><i class="fa fa-check"></i><b>13.5</b> Pros and cons</a></li>
<li class="chapter" data-level="13.6" data-path="LIME.html"><a href="LIME.html#LIMERcode"><i class="fa fa-check"></i><b>13.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="13.6.1" data-path="LIME.html"><a href="LIME.html#the-lime-package"><i class="fa fa-check"></i><b>13.6.1</b> The lime package</a></li>
<li class="chapter" data-level="13.6.2" data-path="LIME.html"><a href="LIME.html#the-localmodel-package"><i class="fa fa-check"></i><b>13.6.2</b> The localModel package</a></li>
<li class="chapter" data-level="13.6.3" data-path="LIME.html"><a href="LIME.html#the-iml-package"><i class="fa fa-check"></i><b>13.6.3</b> The iml package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html"><i class="fa fa-check"></i><b>14</b> Summary of Instance-level Explainers</a><ul>
<li class="chapter" data-level="14.1" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#number-of-explanatory-variables-in-the-model"><i class="fa fa-check"></i><b>14.1</b> Number of explanatory variables in the model</a><ul>
<li class="chapter" data-level="14.1.1" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#low-to-medium-number-of-explanatory-variables"><i class="fa fa-check"></i><b>14.1.1</b> Low to medium number of explanatory variables</a></li>
<li class="chapter" data-level="14.1.2" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#medium-to-large-number-of-explanatory-variables"><i class="fa fa-check"></i><b>14.1.2</b> Medium to large number of explanatory variables</a></li>
<li class="chapter" data-level="14.1.3" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#very-large-number-of-explanatory-variables"><i class="fa fa-check"></i><b>14.1.3</b> Very large number of explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#correlated-explanatory-variables"><i class="fa fa-check"></i><b>14.2</b> Correlated explanatory variables</a></li>
<li class="chapter" data-level="14.3" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#models-with-interactions"><i class="fa fa-check"></i><b>14.3</b> Models with interactions</a></li>
<li class="chapter" data-level="14.4" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#sparse-explanations"><i class="fa fa-check"></i><b>14.4</b> Sparse explanations</a></li>
<li class="chapter" data-level="14.5" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#additional-uses-of-model-exploration-and-explanation"><i class="fa fa-check"></i><b>14.5</b> Additional uses of model exploration and explanation</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html"><i class="fa fa-check"></i><b>15</b> Use Case for FIFA 19</a><ul>
<li class="chapter" data-level="15.1" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#introduction-1"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#data-preparation-1"><i class="fa fa-check"></i><b>15.2</b> Data preparation</a></li>
<li class="chapter" data-level="15.3" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#model-assembly-1"><i class="fa fa-check"></i><b>15.3</b> Model assembly</a></li>
<li class="chapter" data-level="15.4" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#create-model-explaienrs"><i class="fa fa-check"></i><b>15.4</b> Create model explaienrs</a></li>
<li class="chapter" data-level="15.5" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#model-performance"><i class="fa fa-check"></i><b>15.5</b> Model performance</a></li>
<li class="chapter" data-level="15.6" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#feature-importance"><i class="fa fa-check"></i><b>15.6</b> Feature importance</a></li>
<li class="chapter" data-level="15.7" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#partial-dependency-profiles"><i class="fa fa-check"></i><b>15.7</b> Partial Dependency Profiles</a></li>
<li class="chapter" data-level="15.8" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#break-down"><i class="fa fa-check"></i><b>15.8</b> Break Down</a></li>
<li class="chapter" data-level="15.9" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#ceteris-paribus-profile"><i class="fa fa-check"></i><b>15.9</b> Ceteris Paribus Profile</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="modelLevelExploration.html"><a href="modelLevelExploration.html"><i class="fa fa-check"></i><b>16</b> Model-level exploration</a></li>
<li class="chapter" data-level="17" data-path="modelPerformance.html"><a href="modelPerformance.html"><i class="fa fa-check"></i><b>17</b> Model Performance Measures</a><ul>
<li class="chapter" data-level="17.1" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceIntro"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceIntuition"><i class="fa fa-check"></i><b>17.2</b> Intuition</a></li>
<li class="chapter" data-level="17.3" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethod"><i class="fa fa-check"></i><b>17.3</b> Method</a><ul>
<li class="chapter" data-level="17.3.1" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodCont"><i class="fa fa-check"></i><b>17.3.1</b> Continuous dependent variable</a></li>
<li class="chapter" data-level="17.3.2" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodBin"><i class="fa fa-check"></i><b>17.3.2</b> Binary dependent variable</a></li>
<li class="chapter" data-level="17.3.3" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodCateg"><i class="fa fa-check"></i><b>17.3.3</b> Categorical dependent variable</a></li>
<li class="chapter" data-level="17.3.4" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodCount"><i class="fa fa-check"></i><b>17.3.4</b> Count dependent variable</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="modelPerformance.html"><a href="modelPerformance.html#example"><i class="fa fa-check"></i><b>17.4</b> Example</a><ul>
<li class="chapter" data-level="17.4.1" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceApartments"><i class="fa fa-check"></i><b>17.4.1</b> Apartments data</a></li>
<li class="chapter" data-level="17.4.2" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceTitanic"><i class="fa fa-check"></i><b>17.4.2</b> Titanic data</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceProsCons"><i class="fa fa-check"></i><b>17.5</b> Pros and cons</a></li>
<li class="chapter" data-level="17.6" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceR"><i class="fa fa-check"></i><b>17.6</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="featureImportance.html"><a href="featureImportance.html"><i class="fa fa-check"></i><b>18</b> Variable’s Importance</a><ul>
<li class="chapter" data-level="18.1" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceIntro"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceIntuition"><i class="fa fa-check"></i><b>18.2</b> Intuition</a></li>
<li class="chapter" data-level="18.3" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceMethod"><i class="fa fa-check"></i><b>18.3</b> Method</a></li>
<li class="chapter" data-level="18.4" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceTitanic"><i class="fa fa-check"></i><b>18.4</b> Example: Titanic data</a></li>
<li class="chapter" data-level="18.5" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceProsCons"><i class="fa fa-check"></i><b>18.5</b> Pros and cons</a></li>
<li class="chapter" data-level="18.6" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceR"><i class="fa fa-check"></i><b>18.6</b> Code snippets for R</a></li>
<li class="chapter" data-level="18.7" data-path="featureImportance.html"><a href="featureImportance.html#more-models"><i class="fa fa-check"></i><b>18.7</b> More models</a></li>
<li class="chapter" data-level="18.8" data-path="featureImportance.html"><a href="featureImportance.html#level-frequency"><i class="fa fa-check"></i><b>18.8</b> Level frequency</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html"><i class="fa fa-check"></i><b>19</b> Partial Dependency Profiles</a><ul>
<li class="chapter" data-level="19.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPIntro"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPIntuition"><i class="fa fa-check"></i><b>19.2</b> Intuition</a></li>
<li class="chapter" data-level="19.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPMethod"><i class="fa fa-check"></i><b>19.3</b> Method</a><ul>
<li class="chapter" data-level="19.3.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#partial-dependency-profiles-1"><i class="fa fa-check"></i><b>19.3.1</b> Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.3.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#clustered-partial-dependency-profiles"><i class="fa fa-check"></i><b>19.3.2</b> Clustered Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.3.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#grouped-partial-dependency-profiles"><i class="fa fa-check"></i><b>19.3.3</b> Grouped Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.3.4" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#contrastive-partial-dependency-profiles"><i class="fa fa-check"></i><b>19.3.4</b> Contrastive Partial Dependency profiles</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPExample"><i class="fa fa-check"></i><b>19.4</b> Example: Apartments data</a><ul>
<li class="chapter" data-level="19.4.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#partial-dependency-profiles-2"><i class="fa fa-check"></i><b>19.4.1</b> Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.4.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#clustered-partial-dependency-profiles-1"><i class="fa fa-check"></i><b>19.4.2</b> Clustered Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.4.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#grouped-partial-dependency-profiles-1"><i class="fa fa-check"></i><b>19.4.3</b> Grouped Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.4.4" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#contrastive-partial-dependency-profiles-1"><i class="fa fa-check"></i><b>19.4.4</b> Contrastive Partial Dependency profiles</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPProsCons"><i class="fa fa-check"></i><b>19.5</b> Pros and cons</a></li>
<li class="chapter" data-level="19.6" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPR"><i class="fa fa-check"></i><b>19.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="19.6.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#clustered-partial-dependency-profiles-2"><i class="fa fa-check"></i><b>19.6.1</b> Clustered Partial Dependency profiles</a></li>
<li class="chapter" data-level="19.6.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#grouped-partial-dependency-profiles-2"><i class="fa fa-check"></i><b>19.6.2</b> Grouped Partial Dependency profiles</a></li>
<li class="chapter" data-level="19.6.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#contrastive-partial-dependency-profiles-2"><i class="fa fa-check"></i><b>19.6.3</b> Contrastive Partial Dependency profiles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html"><i class="fa fa-check"></i><b>20</b> Accumulated Local Profiles</a><ul>
<li class="chapter" data-level="20.1" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPIntro"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
<li class="chapter" data-level="20.2" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPIntuition"><i class="fa fa-check"></i><b>20.2</b> Intuition</a></li>
<li class="chapter" data-level="20.3" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPMethod"><i class="fa fa-check"></i><b>20.3</b> Method</a><ul>
<li class="chapter" data-level="20.3.1" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#partial-dependency-profile"><i class="fa fa-check"></i><b>20.3.1</b> Partial Dependency Profile</a></li>
<li class="chapter" data-level="20.3.2" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#conditional-dependency-profile"><i class="fa fa-check"></i><b>20.3.2</b> Conditional Dependency Profile</a></li>
<li class="chapter" data-level="20.3.3" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#accumulated-local-profile"><i class="fa fa-check"></i><b>20.3.3</b> Accumulated Local Profile</a></li>
<li class="chapter" data-level="20.3.4" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#summaryFeatureEffects"><i class="fa fa-check"></i><b>20.3.4</b> Comparison of Explainers for Feature Effects</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#CDPExample"><i class="fa fa-check"></i><b>20.4</b> Example: Apartments data</a></li>
<li class="chapter" data-level="20.5" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPProsCons"><i class="fa fa-check"></i><b>20.5</b> Pros and cons</a></li>
<li class="chapter" data-level="20.6" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPR"><i class="fa fa-check"></i><b>20.6</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html"><i class="fa fa-check"></i><b>21</b> Residual Diagnostic</a><ul>
<li class="chapter" data-level="21.1" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html#introduction-2"><i class="fa fa-check"></i><b>21.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html#intuition"><i class="fa fa-check"></i><b>21.2</b> Intuition</a></li>
<li class="chapter" data-level="21.3" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html#code-snippets-for-r"><i class="fa fa-check"></i><b>21.3</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ccUseCase.html"><a href="ccUseCase.html"><i class="fa fa-check"></i><b>22</b> Use Case: Call Center</a><ul>
<li class="chapter" data-level="22.1" data-path="ccUseCase.html"><a href="ccUseCase.html#introduction-3"><i class="fa fa-check"></i><b>22.1</b> Introduction</a></li>
<li class="chapter" data-level="22.2" data-path="ccUseCase.html"><a href="ccUseCase.html#iteration-1-crisp-modeling"><i class="fa fa-check"></i><b>22.2</b> Iteration 1: Crisp modeling</a><ul>
<li class="chapter" data-level="22.2.1" data-path="ccUseCase.html"><a href="ccUseCase.html#data-preparation-2"><i class="fa fa-check"></i><b>22.2.1</b> Data preparation</a></li>
<li class="chapter" data-level="22.2.2" data-path="ccUseCase.html"><a href="ccUseCase.html#data-exploration-1"><i class="fa fa-check"></i><b>22.2.2</b> Data exploration</a></li>
<li class="chapter" data-level="22.2.3" data-path="ccUseCase.html"><a href="ccUseCase.html#model-assembly-2"><i class="fa fa-check"></i><b>22.2.3</b> Model assembly</a></li>
<li class="chapter" data-level="22.2.4" data-path="ccUseCase.html"><a href="ccUseCase.html#model-understanding-1"><i class="fa fa-check"></i><b>22.2.4</b> Model understanding</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="ccUseCase.html"><a href="ccUseCase.html#iteration-2-fine-tuning"><i class="fa fa-check"></i><b>22.3</b> Iteration 2: Fine tuning</a><ul>
<li class="chapter" data-level="22.3.1" data-path="ccUseCase.html"><a href="ccUseCase.html#analysis-of-residuals"><i class="fa fa-check"></i><b>22.3.1</b> Analysis of residuals</a></li>
<li class="chapter" data-level="22.3.2" data-path="ccUseCase.html"><a href="ccUseCase.html#sensitivity-analysis"><i class="fa fa-check"></i><b>22.3.2</b> Sensitivity analysis</a></li>
<li class="chapter" data-level="22.3.3" data-path="ccUseCase.html"><a href="ccUseCase.html#deeper-analysis-of-individual-observations"><i class="fa fa-check"></i><b>22.3.3</b> Deeper analysis of individual observations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendixes.html"><a href="appendixes.html"><i class="fa fa-check"></i>Appendixes</a></li>
<li class="chapter" data-level="23" data-path="conceptDrift.html"><a href="conceptDrift.html"><i class="fa fa-check"></i><b>23</b> Concept Drift</a><ul>
<li class="chapter" data-level="23.1" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftIntro"><i class="fa fa-check"></i><b>23.1</b> Introduction</a></li>
<li class="chapter" data-level="23.2" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftIntuition"><i class="fa fa-check"></i><b>23.2</b> Intuition</a></li>
<li class="chapter" data-level="23.3" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftMethod"><i class="fa fa-check"></i><b>23.3</b> Method</a></li>
<li class="chapter" data-level="23.4" data-path="conceptDrift.html"><a href="conceptDrift.html#covariate-drift"><i class="fa fa-check"></i><b>23.4</b> Covariate Drift</a></li>
<li class="chapter" data-level="23.5" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftExample"><i class="fa fa-check"></i><b>23.5</b> Example: Titanic data</a></li>
<li class="chapter" data-level="23.6" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftProsCons"><i class="fa fa-check"></i><b>23.6</b> Pros and cons</a></li>
<li class="chapter" data-level="23.7" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftR"><i class="fa fa-check"></i><b>23.7</b> Code snippets for R</a></li>
<li class="chapter" data-level="23.8" data-path="conceptDrift.html"><a href="conceptDrift.html#residual-drift"><i class="fa fa-check"></i><b>23.8</b> Residual Drift</a></li>
<li class="chapter" data-level="23.9" data-path="conceptDrift.html"><a href="conceptDrift.html#code-snippets"><i class="fa fa-check"></i><b>23.9</b> Code snippets</a></li>
<li class="chapter" data-level="23.10" data-path="conceptDrift.html"><a href="conceptDrift.html#model-drift"><i class="fa fa-check"></i><b>23.10</b> Model Drift</a></li>
<li class="chapter" data-level="23.11" data-path="conceptDrift.html"><a href="conceptDrift.html#code-snippets-1"><i class="fa fa-check"></i><b>23.11</b> Code snippets</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="data-set-hr.html"><a href="data-set-hr.html"><i class="fa fa-check"></i><b>24</b> Data Set HR</a><ul>
<li class="chapter" data-level="24.1" data-path="data-set-hr.html"><a href="data-set-hr.html#HFDataset"><i class="fa fa-check"></i><b>24.1</b> Hire or fire</a><ul>
<li class="chapter" data-level="24.1.1" data-path="data-set-hr.html"><a href="data-set-hr.html#exploration-HR"><i class="fa fa-check"></i><b>24.1.1</b> Data exploration</a></li>
<li class="chapter" data-level="24.1.2" data-path="data-set-hr.html"><a href="data-set-hr.html#model-HR-mr"><i class="fa fa-check"></i><b>24.1.2</b> Multinomial logistic regression</a></li>
<li class="chapter" data-level="24.1.3" data-path="data-set-hr.html"><a href="data-set-hr.html#model-HR-rf"><i class="fa fa-check"></i><b>24.1.3</b> Random forest</a></li>
<li class="chapter" data-level="24.1.4" data-path="data-set-hr.html"><a href="data-set-hr.html#predictionsHR"><i class="fa fa-check"></i><b>24.1.4</b> Model predictions</a></li>
<li class="chapter" data-level="24.1.5" data-path="data-set-hr.html"><a href="data-set-hr.html#ListOfModelsHR"><i class="fa fa-check"></i><b>24.1.5</b> List of objects for the <code>HR</code> example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/pbiecek/DALEX" target="blank">DALEX website</a></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Predictive Models: Explore, Explain, and Debug</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ceterisParibus" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Ceteris-paribus Profiles and What-If Analysis</h1>
<div id="CPIntro" class="section level2">
<h2><span class="header-section-number">7.1</span> Introduction</h2>
<p><em>Ceteris paribus</em> is a Latin phrase meaning “other things held constant” or “all else unchanged.” In this chapter, we introduce a technique for model exploration based on the <em>Ceteris paribus</em> principle. In particular, we examine the influence of each explanatory variable, assuming that effects of all other variables are unchanged. The main goal is to understand how changes in a single explanatory variable affects model predictions.</p>
<p>Explanation tools (explainers) presented in this chapter are linked to the second law introduced in Section <a href="introduction.html#three-single-laws">1.3</a>, i.e. the law of “Prediction’s speculation.” This is why the tools are also known as <em>What-If model analysis</em> or <em>Individual Conditional Expectations</em> <span class="citation">(Goldstein et al. <a href="#ref-ICEbox">2015</a>)</span>. It appears that it is easier to understand how a black-box model is working if we can explore the model by investigating the influence of explanatory variables separately, changing one at a time.</p>
</div>
<div id="CPIntuition" class="section level2">
<h2><span class="header-section-number">7.2</span> Intuition</h2>
<p>Panel A of Figure <a href="ceterisParibus.html#fig:modelResponseCurveLine">7.1</a> presents response (prediction) surface for the <code>titanic_lmr_v6</code> model for two explanatory variables, <em>age</em> and <em>class</em>, from the <em>titanic</em> dataset (see Section <a href="dataSetsIntro.html#TitanicDataset">5.1</a>). We are interested in the change of the model prediction induced by each of the variables. Toward this end, we may want to explore the curvature of the response surface around a single point with <em>age</em> equal to 47 and <em>class</em> equal to “1st,” indicated in the plot. Ceteris-paribus (CP) profiles are one-dimensional profiles that examine the curvature across each dimension, i.e., for each variable. Panel B of Figure <a href="ceterisParibus.html#fig:modelResponseCurveLine">7.1</a> presents the profiles corresponding to <em>age</em> and <em>class</em>. Note that, in the CP profile for <em>age</em>, the point of interest is indicated by the black dot. In essence, a CP profile shows a conditional expectation of the dependent variable (response) for the particular explanatory variable.</p>
<div class="figure" style="text-align: center"><span id="fig:modelResponseCurveLine"></span>
<img src="figure/profile_age_class.png" alt="(fig:modelResponseCurveLine) A) Model response (prediction) surface. Ceteris-paribus (CP) profiles marked with black curves help to understand the curvature of the surface while changing only a single explanatory variable. B) CP profiles for individual variables, age (continuous) and class (categorical)." width="70%" />
<p class="caption">
Figure 7.1: (fig:modelResponseCurveLine) A) Model response (prediction) surface. Ceteris-paribus (CP) profiles marked with black curves help to understand the curvature of the surface while changing only a single explanatory variable. B) CP profiles for individual variables, age (continuous) and class (categorical).
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:modelResponseCurveAnimation"></span>
<img src="figure/profile_age_class.gif" alt="(fig:modelResponseCurveAnimation) Animated model response 2D surface as in (fig:modelResponseCurveLine)." width="70%" />
<p class="caption">
Figure 7.2: (fig:modelResponseCurveAnimation) Animated model response 2D surface as in (fig:modelResponseCurveLine).
</p>
</div>
<p>CP belongs to the class of techniques that examine local curvature of the model response surface. Other very popular technique from this class called LIME is presented in Chapter <a href="LIME.html#LIME">13</a>.</p>
<p>CP technique is similar to the LIME method (see Chapter <a href="LIME.html#LIME">13</a>). LIME and CP profiles examine the curvature of response surface of a model. The difference between these two methods lies in the fact that LIME approximates the model of interest locally with a simpler glass-box model. Usually, the LIME model is sparse, i.e., contains fewer explanatory variables. Thus, one needs to investigate a plot across a smaller number of dimensions. On the other hand, the CP profiles present conditional predictions for every variable and, in most cases, are easier to interpret. More detailed comparison of these techniques is presented in the Chapter <a href="summaryInstanceLevel.html#summaryInstanceLevel">14</a>.</p>
</div>
<div id="CPMethod" class="section level2">
<h2><span class="header-section-number">7.3</span> Method</h2>
<p>In this section, we introduce more formally one-dimensional CP profiles.</p>
<p>In predictive modeling, we are interested in a distribution of a dependent variable <span class="math inline">\(Y\)</span> given vector <span class="math inline">\(x_*\)</span>. The latter contains values of explanatory variables. In the ideal world, we would like to know the conditional distribution of <span class="math inline">\(Y\)</span> given <span class="math inline">\(x_*\)</span>. In practical applications, however, we usually do not predict the entire distribution, but just some of its characteristics like the expected (mean) value, a quantile, or variance. Without loss of generality we will assume that we model the conditional expected value <span class="math inline">\(E_Y(Y | x_*)\)</span>.</p>
<p>Assume that we have got model <span class="math inline">\(f()\)</span>, for which <span class="math inline">\(f(x_*)\)</span> is an approximation of <span class="math inline">\(E_Y(Y | x_*)\)</span>, i.e., <span class="math inline">\(E_Y(Y | x_*) \approx f(x_*)\)</span>. Note that we do not assume that it is a “good” model, nor that the approximation is precise. We simply assume that we have got a model that is used to estimate the conditional expected value and to form predictions of the values of the dependent variable. Our interest lies in the evaluation of the quality of the predictions. If the model offers a “good” approximation of the conditional expected value, it should be reflected in its satisfactory predictive performance.</p>
<p>Recall (see Section <a href="introduction.html#notation">1.8</a>) that we use <span class="math inline">\(x_i\)</span> to refer to the vector corresponding to the <span class="math inline">\(i\)</span>-th observation in a dataset. Let <span class="math inline">\(x^{j}_{*}\)</span> denote the <span class="math inline">\(j\)</span>-th element of <span class="math inline">\(x_{*}\)</span>, i.e., the <span class="math inline">\(j\)</span>-th explanatory variable. We use <span class="math inline">\(x^{-j}_{*}\)</span> to refer to a vector resulting from removing the <span class="math inline">\(j\)</span>-th element from <span class="math inline">\(x_{*}\)</span>. By <span class="math inline">\(x^{j|=z}_{*}\)</span>, we denote a vector resulting from changing the value of the <span class="math inline">\(j\)</span>-th element of <span class="math inline">\(x_{*}\)</span> to (a scalar) <span class="math inline">\(z\)</span>.</p>
<p>We define a one-dimensional CP profile <span class="math inline">\(h()\)</span> for model <span class="math inline">\(f()\)</span>, the <span class="math inline">\(j\)</span>-th explanatory variable, and point <span class="math inline">\(x_*\)</span> as follows:</p>
<p><span class="math display">\[
h^{f,j}_{x_*}(z) := f(x_*|^j=z).
\]</span>
CP profile is a function that provides the dependence of the approximated expected value (prediction) of <span class="math inline">\(Y\)</span> on the value <span class="math inline">\(z\)</span> of the <span class="math inline">\(j\)</span>-th explanatory variable. Note that, in practice, <span class="math inline">\(z\)</span> is taken to go through the entire range of values typical for the variable, while values of all other explanatory variables are kept fixed at the values specified by <span class="math inline">\(x_*\)</span>.</p>
<p>Note that in the situation when only a single model is considered, we will skip the model index and we will denote the CP profile for the <span class="math inline">\(j\)</span>-th explanatory variable and the point of interest <span class="math inline">\(x_*\)</span> by <span class="math inline">\(h^{j}_{x_*}(z)\)</span>.</p>
</div>
<div id="CPExample" class="section level2">
<h2><span class="header-section-number">7.4</span> Example: Titanic</h2>
<p>For continuous explanatory variables, a natural way to represent the CP function is to use a profile plot similar to the ones presented in Figure <a href="ceterisParibus.html#fig:profileAgeRf">7.3</a>. In the figure, the dot on the curves marks an instance prediction, i.e., prediction <span class="math inline">\(f(x_*)\)</span> for a single observation <span class="math inline">\(x_*\)</span>. The curve itself shows how the prediction would change if the value of a particular explanatory variable changed.</p>
<p>Figure <a href="ceterisParibus.html#fig:profileAgeRf">7.3</a> presents CP profiles for the <em>age</em> variable in the logistic regression and random forest models for the Titanic dataset (see Sections <a href="dataSetsIntro.html#model-titanic-lmr">5.1.2</a> and <a href="dataSetsIntro.html#model-titanic-rf">5.1.3</a>, respectively). It is worth observing that the profile for the logistic regression model is smooth, while the one for the random forest model shows more variability. For this instance (observation), the prediction for the logistic regression model would increase substantially if the value of <em>age</em> became lower than 20. For the random forrest model, a substantial increase would be obtained if <em>age</em> became lower than 13 or so.</p>
<div class="figure" style="text-align: center"><span id="fig:profileAgeRf"></span>
<img src="figure/profile_age_rf.png" alt="(fig:profileAgeRf) Ceteris-paribus profiles for variable `age` for the logistic regression (`titanic_lmr_v6`) and random forest (`titanic_rf_v6` ) models that predict the probability of surviving based on the Titanic data" width="70%" />
<p class="caption">
Figure 7.3: (fig:profileAgeRf) Ceteris-paribus profiles for variable <code>age</code> for the logistic regression (<code>titanic_lmr_v6</code>) and random forest (<code>titanic_rf_v6</code> ) models that predict the probability of surviving based on the Titanic data
</p>
</div>
<p>For a categorical explanatory variable, a natural way to represent the CP function is to use a barplot similar to the ones presented in Figure <a href="ceterisParibus.html#fig:profileAgeRf2">7.4</a>. The barplots in Figure <a href="ceterisParibus.html#fig:profileAgeRf">7.3</a> present CP profiles for the <em>class</em> variable in the logistic regression and random forest models for the Titanic dataset (see Sections <a href="dataSetsIntro.html#model-titanic-lmr">5.1.2</a> and <a href="dataSetsIntro.html#model-titanic-rf">5.1.3</a>, respectively). For this instance (observation), the predicted probability for the logistic regression model would decrease substantially if the value of <em>class</em> changed to “2nd”. On the other hand, for the random forest model, the largest change would be marked if <em>class</em> changed to “restaurant staff”.</p>
<div class="figure" style="text-align: center"><span id="fig:profileAgeRf2"></span>
<img src="figure/profile_class_rf.png" alt="(fig:profileAgeRf2) Ceteris-paribus profiles for variable `class` for the logistic regression (`titanic_lmr_v6`) and random forest (`titanic_rf_v6` ) models that predict the probability of surviving based on the Titanic data" width="70%" />
<p class="caption">
Figure 7.4: (fig:profileAgeRf2) Ceteris-paribus profiles for variable <code>class</code> for the logistic regression (<code>titanic_lmr_v6</code>) and random forest (<code>titanic_rf_v6</code> ) models that predict the probability of surviving based on the Titanic data
</p>
</div>
<p>Usually, black-box models contain a large number of explanatory variables. However, CP profiles are legible even for tiny subplots, created with techniques like sparklines or small multiples <span class="citation">(Tufte <a href="#ref-Tufte1986">1986</a>)</span>. In this way we can display a large number of profiles at the same time keeping profiles for consecutive variables in separate panels, as shown in Figure <a href="ceterisParibus.html#fig:profileV4Rf">7.5</a> for the random forest model for the Titanic dataset. It helps if these panels are ordered so that the most important profiles are listed first. We discuss a method to assess the importance of CP profiles in the next chapter.</p>
<div class="figure" style="text-align: center"><span id="fig:profileV4Rf"></span>
<img src="figure/profile_v4_rf3.png" alt="(fig:profileV4Rf) Ceteris-paribus profiles for all continuous explanatory variables for the random forest (`titanic_rf_v6`) model for the `titanic` dataset" width="70%" />
<p class="caption">
Figure 7.5: (fig:profileV4Rf) Ceteris-paribus profiles for all continuous explanatory variables for the random forest (<code>titanic_rf_v6</code>) model for the <code>titanic</code> dataset
</p>
</div>
</div>
<div id="CPProsCons" class="section level2">
<h2><span class="header-section-number">7.5</span> Pros and cons</h2>
<p>One-dimensional CP profiles, as presented in this chapter, offer a uniform, easy to communicate and extendable approach to model exploration. Their graphical representation is easy to understand and explain. It is possible to show profiles for many variables or models in a single plot. CP profiles are easy to compare, thus we can juxtapose two or more models to better understand differences between models. We can also compare two or more instances to better understand model stability. CP profiles are also a useful tool for sensitivity analysis.</p>
<p>There are several issues related to the use of the CP profiles. If explanatory variables are correlated, then changing one variable implies a change in the other. In such case, the application of the <em>Ceteris paribus</em> principle may lead to unrealistic settings, as it is not possible to keep one variable fixed while varying the other one. For example, apartment’s price prediction features like surface and number of rooms are correlated thus it is unrealistic to consider very small apartments with extreme number of rooms. Special cases are interactions, which require the use of two-dimensional CP profiles that are more complex than one-dimensional ones. Also, in case of a model with hundreds or thousands of variables, the number of plots to inspect may be daunting. Finally, while barplots allow visualization of CP profiles for factors (categorical explanatory variables), their use becomes less trivial in case of factors with many nominal (unordered) categories (like, for example, a ZIP-code).</p>
</div>
<div id="CPR" class="section level2">
<h2><span class="header-section-number">7.6</span> Code snippets for R</h2>
<p>In this section, we present key features of the R package <code>ingredients</code> <span class="citation">(Biecek et al. <a href="#ref-ingredientsRPackage">2019</a>)</span> which is a part of <code>DrWhy.AI</code> universe and covers all methods presented in this chapter. More details and examples can be found at <a href="https://modeloriented.github.io/ingredients/" class="uri">https://modeloriented.github.io/ingredients/</a>.</p>
<p>Note that there are also other R packages that offer similar functionality, like <code>condvis</code> <span class="citation">(O’Connell, Hurley, and Domijan <a href="#ref-condvisRPackage">2017</a>)</span>, <code>pdp</code> <span class="citation">(Greenwell <a href="#ref-pdpRPackage">2017</a>)</span>, <code>ICEbox</code> <span class="citation">(Goldstein et al. <a href="#ref-ICEbox">2015</a>)</span>, <code>ALEPlot</code> <span class="citation">(Apley <a href="#ref-ALEPlotRPackage">2018</a>)</span>, <code>iml</code> <span class="citation">(Molnar, Bischl, and Casalicchio <a href="#ref-imlRPackage">2018</a>)</span>.</p>
<p>For illustration, we use two classification models developed in Chapter <a href="dataSetsIntro.html#TitanicDataset">5.1</a>, namely the logistic regression model <code>titanic_lmr_v6</code> (Section <a href="dataSetsIntro.html#model-titanic-lmr">5.1.2</a>) and the random forest model <code>titanic_rf_v6</code> (Section <a href="dataSetsIntro.html#model-titanic-rf">5.1.3</a>). They are developed to predict the probability of survival after sinking of Titanic. Instance-level explanations are calculated for a single observation <code>henry</code> - a 47 years old male passenger that travelled in the 1st class.</p>
<p><code>DALEX</code> explainers for both models and the <code>henry</code> data frame are retrieved via the <code>archivist</code> hooks as listed in Section <a href="dataSetsIntro.html#ListOfModelsTitanic">5.1.7</a>.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;rms&quot;</span>)</a>
<a class="sourceLine" id="cb59-2" data-line-number="2">explain_lmr_v6 &lt;-<span class="st"> </span>archivist<span class="op">::</span><span class="kw">aread</span>(<span class="st">&quot;pbiecek/models/2b9b6&quot;</span>)</a>
<a class="sourceLine" id="cb59-3" data-line-number="3"></a>
<a class="sourceLine" id="cb59-4" data-line-number="4"><span class="kw">library</span>(<span class="st">&quot;randomForest&quot;</span>)</a>
<a class="sourceLine" id="cb59-5" data-line-number="5">explain_rf_v6 &lt;-<span class="st"> </span>archivist<span class="op">::</span><span class="kw">aread</span>(<span class="st">&quot;pbiecek/models/9b971&quot;</span>)</a>
<a class="sourceLine" id="cb59-6" data-line-number="6"></a>
<a class="sourceLine" id="cb59-7" data-line-number="7"><span class="kw">library</span>(<span class="st">&quot;DALEX&quot;</span>)</a>
<a class="sourceLine" id="cb59-8" data-line-number="8">henry &lt;-<span class="st"> </span>archivist<span class="op">::</span><span class="kw">aread</span>(<span class="st">&quot;pbiecek/models/a6538&quot;</span>)</a>
<a class="sourceLine" id="cb59-9" data-line-number="9">henry</a></code></pre></div>
<pre><code>##   class gender age sibsp parch fare  embarked
## 1   1st   male  47     0     0   25 Cherbourg</code></pre>
<div id="basic-use-of-the-ceteris_paribus-function" class="section level3">
<h3><span class="header-section-number">7.6.1</span> Basic use of the <code>ceteris_paribus</code> function</h3>
<p>The easiest way to create and plot CP profiles is to call <code>ceteris_paribus()</code> function and then the generic <code>plot()</code> function. By default, profiles for all variables are being calculated and all numeric features are being plotted. One can limit the number of variables that should be considered with the <code>variables</code> argument.</p>
<p>To obtain CP profiles, the <code>ceteris_paribus()</code> function requires the explainer-object and the instance data frame as arguments. As a result, the function yields an object od the class <code>ceteris_paribus_explainer</code>. It is a data frame with model predictions.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;ingredients&quot;</span>)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2">cp_titanic_rf &lt;-<span class="st"> </span><span class="kw">ceteris_paribus</span>(explain_rf_v6, henry)</a>
<a class="sourceLine" id="cb61-3" data-line-number="3">cp_titanic_rf</a></code></pre></div>
<pre><code>## Top profiles    : 
##                class gender age sibsp parch fare  embarked _yhat_ _vname_ _ids_
## 1                3rd   male  47     0     0   25 Cherbourg  0.100   class     1
## 1.1              2nd   male  47     0     0   25 Cherbourg  0.054   class     1
## 1.2              1st   male  47     0     0   25 Cherbourg  0.246   class     1
## 1.3 engineering crew   male  47     0     0   25 Cherbourg  0.096   class     1
## 1.4 victualling crew   male  47     0     0   25 Cherbourg  0.098   class     1
## 1.5 restaurant staff   male  47     0     0   25 Cherbourg  0.092   class     1
##              _label_
## 1   Random Forest v6
## 1.1 Random Forest v6
## 1.2 Random Forest v6
## 1.3 Random Forest v6
## 1.4 Random Forest v6
## 1.5 Random Forest v6
## 
## 
## Top observations:
##   class gender age sibsp parch fare  embarked _yhat_          _label_ _ids_
## 1   1st   male  47     0     0   25 Cherbourg  0.246 Random Forest v6     1</code></pre>
<p>To obtain a graphical representation of CP profiles, the generic <code>plot()</code> function can be applied to the data frame returned by the <code>ceteris_paribus()</code> function. It returns a <code>ggplot2</code> object that can be processed further if needed. In the examples below, we use the <code>ggplot2</code> functions, like <code>ggtitle()</code> or <code>ylim()</code>, to modify plot’s title or the range of the Y-axis.</p>
<p>The resulting plot can be enriched with additional data by applying functions <code>ingredients::show_rugs</code> (adds rugs for the selected points), <code>ingredients::show_observations</code> (adds dots that shows observations), or <code>ingredients::show_aggreagated_profiles</code>. All these functions can take additional arguments to modify size, color, or linetype.</p>
<p>Below we show an R snippet that can be used to replicate plots presented in the upper part of Figure <a href="ceterisParibus.html#fig:profileV4Rf">7.5</a>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</a>
<a class="sourceLine" id="cb63-2" data-line-number="2"><span class="kw">plot</span>(cp_titanic_rf, <span class="dt">variables =</span> <span class="kw">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;fare&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="st">  </span><span class="kw">show_observations</span>(cp_titanic_rf, <span class="dt">variables =</span> <span class="kw">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;fare&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Ceteris Paribus Profiles&quot;</span>, <span class="st">&quot;For the random forest model and the Titanic dataset&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:titanicCeterisProfile01"></span>
<img src="PM_VEE_files/figure-html/titanicCeterisProfile01-1.png" alt="Ceteris-paribus profiles for `age` and `fare` variables and the `titanic_rf_v6` model." width="70%" />
<p class="caption">
Figure 7.6: Ceteris-paribus profiles for <code>age</code> and <code>fare</code> variables and the <code>titanic_rf_v6</code> model.
</p>
</div>
<p>By default, all numerical variables are plotted.
To plot CP profiles for categorical variables, we have got to add the <code>only_numerical = FALSE</code> argument to the <code>plot()</code> function. The code below an be used to recreate the right-hand-side plot from Figure <a href="ceterisParibus.html#fig:profileAgeRf2">7.4</a>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw">plot</span>(cp_titanic_rf, <span class="dt">variables =</span> <span class="kw">c</span>(<span class="st">&quot;class&quot;</span>, <span class="st">&quot;embarked&quot;</span>), <span class="dt">only_numerical =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Ceteris Paribus Profiles&quot;</span>, <span class="st">&quot;For the random forest model and the Titanic dataset&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:titanicCeterisProfile01B"></span>
<img src="PM_VEE_files/figure-html/titanicCeterisProfile01B-1.png" alt="Ceteris-paribus profiles for `class` and `embarked` variables and the `titanic_rf_v6` model." width="70%" />
<p class="caption">
Figure 7.7: Ceteris-paribus profiles for <code>class</code> and <code>embarked</code> variables and the <code>titanic_rf_v6</code> model.
</p>
</div>
</div>
<div id="advanced-use-of-the-ceteris_paribus-function" class="section level3">
<h3><span class="header-section-number">7.6.2</span> Advanced use of the <code>ceteris_paribus</code> function</h3>
<p>The <code>ceteris_paribus()</code> is a very flexible function. To better understand how it can be used, we briefly review its arguments.</p>
<ul>
<li><code>x</code>, <code>data</code>, <code>predict_function</code>, <code>label</code> - information about a model. If <code>x</code> is created with the <code>DALEX::explain</code> function, then other arguments are extracted from <code>x</code>; this is how we use the function in this chapter. Otherwise, we have got to specify directly the model, the validation data, the predict function, and the model label.</li>
<li><code>new_observation</code> - instance (one or more), for which we want to calculate CP profiles. It should be a data frame with same variables as in the validation data.</li>
<li><code>y</code> - observed value of the dependent variable for <code>new_observation</code>. The use of this argument is illustrated in Section <a href="localDiagnostics.html#cPLocDiagIntro">9.1</a>.</li>
<li><code>variables</code> - names of explanatory variables, for which CP profiles are to be calculated. By default, the profiles will be constructed for all variables, which may be time consuming.</li>
<li><code>variable_splits</code> - a list of values for which CP profiles are to be calculated. By default, these are all values for categorical variables. For continuous variables, uniformly-placed values are selected; one can specify the number of the values with the <code>grid_points</code> argument (the default is 101).</li>
</ul>
<p>The code below allows to obtain the plots in the upper part of Figure <a href="ceterisParibus.html#fig:profileV4Rf">7.5</a>. The argument <code>variable_splits</code> specifies the variables (<code>age</code> and <code>fare</code>) for which CP profiles are to be calculated, together with the list of values at which the profiles are to be evaluated.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">cp_titanic_rf &lt;-<span class="st"> </span><span class="kw">ceteris_paribus</span>(explain_rf_v6, henry,</a>
<a class="sourceLine" id="cb65-2" data-line-number="2">              <span class="dt">variable_splits =</span> <span class="kw">list</span>(<span class="dt">age =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">70</span>, <span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb65-3" data-line-number="3">                                     <span class="dt">fare =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.1</span>)))</a></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="kw">plot</span>(cp_titanic_rf) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="st">  </span><span class="kw">show_observations</span>(cp_titanic_rf, <span class="dt">variables =</span> <span class="kw">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;fare&quot;</span>), <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb66-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Ceteris Paribus Profiles&quot;</span>, <span class="st">&quot;For the random forest model and titanic dataset&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:titanicCeterisProfile01C"></span>
<img src="PM_VEE_files/figure-html/titanicCeterisProfile01C-1.png" alt="Ceteris-paribus profiles for `class` and `embarked` variables and the `titanic_rf_v6` model. Blue dot stands for `henry`." width="70%" />
<p class="caption">
Figure 7.8: Ceteris-paribus profiles for <code>class</code> and <code>embarked</code> variables and the <code>titanic_rf_v6</code> model. Blue dot stands for <code>henry</code>.
</p>
</div>
<p>To enhance the plot, additional functions can be used. The generic <code>plot()</code> function creates a <code>ggplot2</code> object with a single <code>geom_line</code> layer. Function <code>show_observations</code> adds <code>geom_point</code> layer, <code>show_rugs</code> adds <code>geom_rugs</code>, while <code>show_profiles</code> adds another <code>geom_line</code>. All these functions take, as the first argument, an object created with the <code>ceteris_paribus</code> function. They can be combined freely to superpose profiles for different models or observations.</p>
<p>In the example below, we present the code to create XO profiles for two passengers, <code>henry</code> and <code>johny_d</code>. Their profiles are included in a plot presented in Figure <a href="ceterisParibus.html#fig:titanicCeterisProfile01D">7.9</a>. We use the <code>scale_color_manual</code> function to add names of passengers to the plot, and to control colors and positions.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">johny_d &lt;-<span class="st"> </span>archivist<span class="op">::</span><span class="kw">aread</span>(<span class="st">&quot;pbiecek/models/e3596&quot;</span>)</a>
<a class="sourceLine" id="cb67-2" data-line-number="2">cp_titanic_rf2 &lt;-<span class="st"> </span><span class="kw">ceteris_paribus</span>(explain_rf_v6, <span class="kw">rbind</span>(henry, johny_d))</a></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw">plot</span>(cp_titanic_rf2, <span class="dt">color =</span> <span class="st">&quot;_ids_&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-2" data-line-number="2"><span class="st">  </span><span class="kw">show_observations</span>(cp_titanic_rf2, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">variables =</span> <span class="kw">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;fare&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-3" data-line-number="3"><span class="st">  </span><span class="kw">show_rugs</span>(cp_titanic_rf2, <span class="dt">sides =</span> <span class="st">&quot;bl&quot;</span>, <span class="dt">variables =</span> <span class="kw">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;fare&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name =</span> <span class="st">&quot;Passenger:&quot;</span>, <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#4378bf&quot;</span>, <span class="st">&quot;#8bdcbe&quot;</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;henry&quot;</span> , <span class="st">&quot;johny_d&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-5" data-line-number="5"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Ceteris Paribus Profiles&quot;</span>, <span class="st">&quot;For the random forest model and the Titanic dataset&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:titanicCeterisProfile01D"></span>
<img src="PM_VEE_files/figure-html/titanicCeterisProfile01D-1.png" alt="Ceteris-paribus profiles for the `titanic_rf_v6` model. Profiles for different passangers are color-coded." width="70%" />
<p class="caption">
Figure 7.9: Ceteris-paribus profiles for the <code>titanic_rf_v6</code> model. Profiles for different passangers are color-coded.
</p>
</div>
</div>
<div id="champion-challenger-analysis" class="section level3">
<h3><span class="header-section-number">7.6.3</span> Champion-challenger analysis</h3>
<p>One of the most interesting uses of the explainers is comparison of CP profiles for two or more of models.</p>
<p>To illustrate this possibility, first, we have go to construct profiles for the models. In our illustration, for the sake of clarity, we limit ourselves just to two models: the logistic regression and random forest models for the Titanic data. Moreover, we only consider the <code>age</code> and <code>fare</code> variables. We use <code>henry</code> as the instance, for which predictions are of interest.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1">cp_titanic_rf &lt;-<span class="st"> </span><span class="kw">ceteris_paribus</span>(explain_rf_v6, henry)</a>
<a class="sourceLine" id="cb69-2" data-line-number="2">cp_titanic_lmr &lt;-<span class="st"> </span><span class="kw">ceteris_paribus</span>(explain_lmr_v6, henry)</a></code></pre></div>
<p>Subsequently, we construct the plot. The result is shown in Figure <a href="ceterisParibus.html#fig:titanicCeterisProfile01E">7.10</a>. Predictions for <code>henry</code> are slightly different, logistic regression returns in this case higher predictions then random forest. For <code>age</code> variable profiles of both models are similar, in both models we see decreasing dependency. While for <code>fare</code> the logistic regression model is slightly positive while random forest is negative. The larger the <code>fare</code> the larger is difference between these models. Such analysis helps us to which degree different models agree on what if scenarios.</p>
<p>Note that every <code>plot</code> and <code>show_*</code> function can take a collection of explainers as arguments. Profiles for different models are included in a single plot. In the presented R snippet, models are color-coded with the help of the argument <code>color = &quot;_label_&quot;</code>, where <code>_label_</code> refers to the name of the column in the CP explainer that contains the model label.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">plot</span>(cp_titanic_rf, cp_titanic_lmr, <span class="dt">color =</span> <span class="st">&quot;_label_&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="st">  </span><span class="kw">show_observations</span>(cp_titanic_rf, cp_titanic_lmr, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">variables =</span> <span class="kw">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;fare&quot;</span>), <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb70-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Selected models:&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Ceteris Paribus Profiles for Henry&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:titanicCeterisProfile01E"></span>
<img src="PM_VEE_files/figure-html/titanicCeterisProfile01E-1.png" alt="Champion-challenger comparison of the `titanic_lmr_v6` and `titanic_rf_v6` models. Profiles for different models are color-coded." width="70%" />
<p class="caption">
Figure 7.10: Champion-challenger comparison of the <code>titanic_lmr_v6</code> and <code>titanic_rf_v6</code> models. Profiles for different models are color-coded.
</p>
</div>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-ALEPlotRPackage">
<p>Apley, Dan. 2018. <em>ALEPlot: Accumulated Local Effects (Ale) Plots and Partial Dependence (Pd) Plots</em>. <a href="https://CRAN.R-project.org/package=ALEPlot">https://CRAN.R-project.org/package=ALEPlot</a>.</p>
</div>
<div id="ref-ingredientsRPackage">
<p>Biecek, Przemyslaw, Hubert Baniecki, Adam Izdebski, and Katarzyna Pekala. 2019. <em>Ingredients: Effects and Importances of Model Ingredients</em>.</p>
</div>
<div id="ref-ICEbox">
<p>Goldstein, Alex, Adam Kapelner, Justin Bleich, and Emil Pitkin. 2015. “Peeking Inside the Black Box: Visualizing Statistical Learning with Plots of Individual Conditional Expectation.” <em>Journal of Computational and Graphical Statistics</em> 24 (1): 44–65. <a href="https://doi.org/10.1080/10618600.2014.907095">https://doi.org/10.1080/10618600.2014.907095</a>.</p>
</div>
<div id="ref-pdpRPackage">
<p>Greenwell, Brandon M. 2017. “pdp: An R Package for Constructing Partial Dependence Plots.” <em>The R Journal</em> 9 (1): 421–36. <a href="https://journal.r-project.org/archive/2017/RJ-2017-016/index.html">https://journal.r-project.org/archive/2017/RJ-2017-016/index.html</a>.</p>
</div>
<div id="ref-imlRPackage">
<p>Molnar, Christoph, Bernd Bischl, and Giuseppe Casalicchio. 2018. “iml: An R package for Interpretable Machine Learning.” <em>JOSS</em> 3 (26). Journal of Open Source Software: 786. <a href="https://doi.org/10.21105/joss.00786">https://doi.org/10.21105/joss.00786</a>.</p>
</div>
<div id="ref-condvisRPackage">
<p>O’Connell, Mark, Catherine Hurley, and Katarina Domijan. 2017. “Conditional Visualization for Statistical Models: An Introduction to the Condvis Package in R.” <em>Journal of Statistical Software, Articles</em> 81 (5): 1–20. <a href="https://doi.org/10.18637/jss.v081.i05">https://doi.org/10.18637/jss.v081.i05</a>.</p>
</div>
<div id="ref-Tufte1986">
<p>Tufte, Edward R. 1986. <em>The Visual Display of Quantitative Information</em>. Cheshire, CT, USA: Graphics Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="InstanceLevelExploration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ceterisParibusOscillations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["PM_VEE.pdf", "PM_VEE.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
