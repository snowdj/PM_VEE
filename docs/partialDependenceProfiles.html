<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Partial Dependency Profiles | Predictive Models: Explore, Explain, and Debug</title>
  <meta name="description" content="This book introduces key concepts for exploration, explanation and visualization of complex predictive models." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Partial Dependency Profiles | Predictive Models: Explore, Explain, and Debug" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book introduces key concepts for exploration, explanation and visualization of complex predictive models." />
  <meta name="github-repo" content="pbiecek/PM_VEE" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Partial Dependency Profiles | Predictive Models: Explore, Explain, and Debug" />
  
  <meta name="twitter:description" content="This book introduces key concepts for exploration, explanation and visualization of complex predictive models." />
  

<meta name="author" content="Przemyslaw Biecek and Tomasz Burzykowski" />


<meta name="date" content="2019-12-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="featureImportance.html"/>
<link rel="next" href="accumulatedLocalProfiles.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-5650686-15', 'https://pbiecek.github.io/PM_VEE/', {
  'anonymizeIp': true
  , 'storage': 'none'
  , 'clientId': window.localStorage.getItem('ga_clientId')
});
ga(function(tracker) {
  window.localStorage.setItem('ga_clientId', tracker.get('clientId'));
});
ga('send', 'pageview');
</script>
<style>
.figure {
   padding:40px 0px;
}
</style>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Predictive Models:<br/> Visualisation, Exploration and Explanation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#notes-to-readers"><i class="fa fa-check"></i><b>1.1</b> Notes to readers</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-aim-of-the-book"><i class="fa fa-check"></i><b>1.2</b> The aim of the book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#three-single-laws"><i class="fa fa-check"></i><b>1.3</b> A bit of philosophy: three laws of model explanation</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#terminology"><i class="fa fa-check"></i><b>1.4</b> Terminology</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#glass-box-models-vs.black-box-models"><i class="fa fa-check"></i><b>1.5</b> Glass-box models vs. black-box models</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#model-visualization-exploration-and-explanation"><i class="fa fa-check"></i><b>1.6</b> Model visualization, exploration, and explanation</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#model-agnostic-vs.model-specific-approach"><i class="fa fa-check"></i><b>1.7</b> Model-agnostic vs. model-specific approach</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#notation"><i class="fa fa-check"></i><b>1.8</b> Notation</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#bookstructure"><i class="fa fa-check"></i><b>1.9</b> The structure of the book</a></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#thanksto"><i class="fa fa-check"></i><b>1.10</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html"><i class="fa fa-check"></i><b>2</b> Do-it-yourself With R</a><ul>
<li class="chapter" data-level="2.1" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#what-to-install"><i class="fa fa-check"></i><b>2.1</b> What to install?</a></li>
<li class="chapter" data-level="2.2" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#how-to-work-with-dalex"><i class="fa fa-check"></i><b>2.2</b> How to work with <code>DALEX</code>?</a></li>
<li class="chapter" data-level="2.3" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#how-to-work-with-archivist"><i class="fa fa-check"></i><b>2.3</b> How to work with <code>archivist</code>?</a></li>
<li class="chapter" data-level="2.4" data-path="doItYourselfWithR.html"><a href="doItYourselfWithR.html#Packages"><i class="fa fa-check"></i><b>2.4</b> DrWhy Packages</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="doItYourselfWithPython.html"><a href="doItYourselfWithPython.html"><i class="fa fa-check"></i><b>3</b> Do-it-yourself With Python</a></li>
<li class="chapter" data-level="4" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html"><i class="fa fa-check"></i><b>4</b> Model Development</a><ul>
<li class="chapter" data-level="4.1" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#MDPIntro"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#the-process"><i class="fa fa-check"></i><b>4.2</b> The Process</a></li>
<li class="chapter" data-level="4.3" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#data-preparation"><i class="fa fa-check"></i><b>4.3</b> Data preparation</a></li>
<li class="chapter" data-level="4.4" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#data-exploration"><i class="fa fa-check"></i><b>4.4</b> Data exploration</a></li>
<li class="chapter" data-level="4.5" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#model-assembly"><i class="fa fa-check"></i><b>4.5</b> Model assembly</a></li>
<li class="chapter" data-level="4.6" data-path="modelDevelopmentProcess.html"><a href="modelDevelopmentProcess.html#model-understanding"><i class="fa fa-check"></i><b>4.6</b> Model understanding</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html"><i class="fa fa-check"></i><b>5</b> Data sets and models</a><ul>
<li class="chapter" data-level="5.1" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#TitanicDataset"><i class="fa fa-check"></i><b>5.1</b> Sinking of the RMS Titanic</a><ul>
<li class="chapter" data-level="5.1.1" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#exploration-titanic"><i class="fa fa-check"></i><b>5.1.1</b> Data exploration</a></li>
<li class="chapter" data-level="5.1.2" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-titanic-lmr"><i class="fa fa-check"></i><b>5.1.2</b> Logistic regression</a></li>
<li class="chapter" data-level="5.1.3" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-titanic-rf"><i class="fa fa-check"></i><b>5.1.3</b> Random forest</a></li>
<li class="chapter" data-level="5.1.4" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-titanic-gbm"><i class="fa fa-check"></i><b>5.1.4</b> Gradient boosting</a></li>
<li class="chapter" data-level="5.1.5" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#predictions-titanic"><i class="fa fa-check"></i><b>5.1.5</b> Model predictions</a></li>
<li class="chapter" data-level="5.1.6" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ExplainersTitanicRCode"><i class="fa fa-check"></i><b>5.1.6</b> Explainers</a></li>
<li class="chapter" data-level="5.1.7" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ListOfModelsTitanic"><i class="fa fa-check"></i><b>5.1.7</b> List of objects for the <code>titanic</code> example</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ApartmentDataset"><i class="fa fa-check"></i><b>5.2</b> Apartment prices</a><ul>
<li class="chapter" data-level="5.2.1" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#exploration-apartments"><i class="fa fa-check"></i><b>5.2.1</b> Data exploration</a></li>
<li class="chapter" data-level="5.2.2" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-Apartments-lr"><i class="fa fa-check"></i><b>5.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="5.2.3" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#model-Apartments-rf"><i class="fa fa-check"></i><b>5.2.3</b> Random forest</a></li>
<li class="chapter" data-level="5.2.4" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#predictionsApartments"><i class="fa fa-check"></i><b>5.2.4</b> Model predictions</a></li>
<li class="chapter" data-level="5.2.5" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ExplainersApartmentsRCode"><i class="fa fa-check"></i><b>5.2.5</b> Explainers</a></li>
<li class="chapter" data-level="5.2.6" data-path="dataSetsIntro.html"><a href="dataSetsIntro.html#ListOfModelsApartments"><i class="fa fa-check"></i><b>5.2.6</b> List of objects for the <code>apartments</code> example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="InstanceLevelExploration.html"><a href="InstanceLevelExploration.html"><i class="fa fa-check"></i><b>6</b> Instance-level exploration</a></li>
<li class="chapter" data-level="7" data-path="ceterisParibus.html"><a href="ceterisParibus.html"><i class="fa fa-check"></i><b>7</b> Ceteris-paribus Profiles and What-If Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPIntro"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPIntuition"><i class="fa fa-check"></i><b>7.2</b> Intuition</a></li>
<li class="chapter" data-level="7.3" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPMethod"><i class="fa fa-check"></i><b>7.3</b> Method</a></li>
<li class="chapter" data-level="7.4" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPExample"><i class="fa fa-check"></i><b>7.4</b> Example: Titanic</a></li>
<li class="chapter" data-level="7.5" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPProsCons"><i class="fa fa-check"></i><b>7.5</b> Pros and cons</a></li>
<li class="chapter" data-level="7.6" data-path="ceterisParibus.html"><a href="ceterisParibus.html#CPR"><i class="fa fa-check"></i><b>7.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="7.6.1" data-path="ceterisParibus.html"><a href="ceterisParibus.html#basic-use-of-the-ceteris_paribus-function"><i class="fa fa-check"></i><b>7.6.1</b> Basic use of the <code>ceteris_paribus</code> function</a></li>
<li class="chapter" data-level="7.6.2" data-path="ceterisParibus.html"><a href="ceterisParibus.html#advanced-use-of-the-ceteris_paribus-function"><i class="fa fa-check"></i><b>7.6.2</b> Advanced use of the <code>ceteris_paribus</code> function</a></li>
<li class="chapter" data-level="7.6.3" data-path="ceterisParibus.html"><a href="ceterisParibus.html#champion-challenger-analysis"><i class="fa fa-check"></i><b>7.6.3</b> Champion-challenger analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html"><i class="fa fa-check"></i><b>8</b> Ceteris-paribus Oscillations and Local Variable-importance</a><ul>
<li class="chapter" data-level="8.1" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscIntro"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscIntuition"><i class="fa fa-check"></i><b>8.2</b> Intuition</a></li>
<li class="chapter" data-level="8.3" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscMethod"><i class="fa fa-check"></i><b>8.3</b> Method</a></li>
<li class="chapter" data-level="8.4" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscExample"><i class="fa fa-check"></i><b>8.4</b> Example: Titanic</a></li>
<li class="chapter" data-level="8.5" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscProsCons"><i class="fa fa-check"></i><b>8.5</b> Pros and cons</a></li>
<li class="chapter" data-level="8.6" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#CPOscR"><i class="fa fa-check"></i><b>8.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="8.6.1" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#basic-use-of-the-calculate_oscillations-function"><i class="fa fa-check"></i><b>8.6.1</b> Basic use of the <code>calculate_oscillations</code> function</a></li>
<li class="chapter" data-level="8.6.2" data-path="ceterisParibusOscillations.html"><a href="ceterisParibusOscillations.html#advanced-use-of-the-calculate_oscillations-function"><i class="fa fa-check"></i><b>8.6.2</b> Advanced use of the <code>calculate_oscillations</code> function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="localDiagnostics.html"><a href="localDiagnostics.html"><i class="fa fa-check"></i><b>9</b> Local Diagnostics With Ceteris-paribus Profiles</a><ul>
<li class="chapter" data-level="9.1" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagIntro"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagIntuition"><i class="fa fa-check"></i><b>9.2</b> Intuition</a></li>
<li class="chapter" data-level="9.3" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagMethod"><i class="fa fa-check"></i><b>9.3</b> Method</a><ul>
<li class="chapter" data-level="9.3.1" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagNeighbors"><i class="fa fa-check"></i><b>9.3.1</b> Nearest neighbors</a></li>
<li class="chapter" data-level="9.3.2" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagProfiles"><i class="fa fa-check"></i><b>9.3.2</b> Profiles for neighbors</a></li>
<li class="chapter" data-level="9.3.3" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagLFplot"><i class="fa fa-check"></i><b>9.3.3</b> Local-fidelity plot</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagExample"><i class="fa fa-check"></i><b>9.4</b> Example: Titanic</a></li>
<li class="chapter" data-level="9.5" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagProsCons"><i class="fa fa-check"></i><b>9.5</b> Pros and cons</a></li>
<li class="chapter" data-level="9.6" data-path="localDiagnostics.html"><a href="localDiagnostics.html#cPLocDiagR"><i class="fa fa-check"></i><b>9.6</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="breakDown.html"><a href="breakDown.html"><i class="fa fa-check"></i><b>10</b> Break-down Plots for Additive Variable Attributions</a><ul>
<li class="chapter" data-level="10.1" data-path="breakDown.html"><a href="breakDown.html#BDIntuition"><i class="fa fa-check"></i><b>10.1</b> Intuition</a></li>
<li class="chapter" data-level="10.2" data-path="breakDown.html"><a href="breakDown.html#BDMethod"><i class="fa fa-check"></i><b>10.2</b> Method</a><ul>
<li class="chapter" data-level="10.2.1" data-path="breakDown.html"><a href="breakDown.html#break-down-for-linear-models"><i class="fa fa-check"></i><b>10.2.1</b> Break-down for linear models</a></li>
<li class="chapter" data-level="10.2.2" data-path="breakDown.html"><a href="breakDown.html#break-down-for-general-case"><i class="fa fa-check"></i><b>10.2.2</b> Break-down for general case</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="breakDown.html"><a href="breakDown.html#BDExample"><i class="fa fa-check"></i><b>10.3</b> Example: Titanic data</a></li>
<li class="chapter" data-level="10.4" data-path="breakDown.html"><a href="breakDown.html#BDProsCons"><i class="fa fa-check"></i><b>10.4</b> Pros and cons</a></li>
<li class="chapter" data-level="10.5" data-path="breakDown.html"><a href="breakDown.html#BDR"><i class="fa fa-check"></i><b>10.5</b> Code snippets for R</a><ul>
<li class="chapter" data-level="10.5.1" data-path="breakDown.html"><a href="breakDown.html#basic-use-of-the-break_down-function"><i class="fa fa-check"></i><b>10.5.1</b> Basic use of the <code>break_down()</code> function</a></li>
<li class="chapter" data-level="10.5.2" data-path="breakDown.html"><a href="breakDown.html#advanced-use-of-the-break_down-function"><i class="fa fa-check"></i><b>10.5.2</b> Advanced use of the <code>break_down()</code> function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="iBreakDown.html"><a href="iBreakDown.html"><i class="fa fa-check"></i><b>11</b> Break-down Plots for Models with Interactions (iBreak-down Plots)</a><ul>
<li class="chapter" data-level="11.1" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDIntuition"><i class="fa fa-check"></i><b>11.1</b> Intuition</a></li>
<li class="chapter" data-level="11.2" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDMethod"><i class="fa fa-check"></i><b>11.2</b> Method</a></li>
<li class="chapter" data-level="11.3" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDExample"><i class="fa fa-check"></i><b>11.3</b> Example: Titanic data</a></li>
<li class="chapter" data-level="11.4" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDProsCons"><i class="fa fa-check"></i><b>11.4</b> Pros and cons</a></li>
<li class="chapter" data-level="11.5" data-path="iBreakDown.html"><a href="iBreakDown.html#iBDRcode"><i class="fa fa-check"></i><b>11.5</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="shapley.html"><a href="shapley.html"><i class="fa fa-check"></i><b>12</b> Shapley Additive Explanations (SHAP) and Average Variable Attributions</a><ul>
<li class="chapter" data-level="12.1" data-path="shapley.html"><a href="shapley.html#SHAPIntuition"><i class="fa fa-check"></i><b>12.1</b> Intuition</a></li>
<li class="chapter" data-level="12.2" data-path="shapley.html"><a href="shapley.html#SHAPMethod"><i class="fa fa-check"></i><b>12.2</b> Method</a></li>
<li class="chapter" data-level="12.3" data-path="shapley.html"><a href="shapley.html#SHAPExample"><i class="fa fa-check"></i><b>12.3</b> Example: Titanic data</a></li>
<li class="chapter" data-level="12.4" data-path="shapley.html"><a href="shapley.html#SHAProsCons"><i class="fa fa-check"></i><b>12.4</b> Pros and cons</a></li>
<li class="chapter" data-level="12.5" data-path="shapley.html"><a href="shapley.html#SHAPRcode"><i class="fa fa-check"></i><b>12.5</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="LIME.html"><a href="LIME.html"><i class="fa fa-check"></i><b>13</b> Local Interpretable Model-agnostic Explanations (LIME)</a><ul>
<li class="chapter" data-level="13.1" data-path="LIME.html"><a href="LIME.html#LIMEIntroduction"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="LIME.html"><a href="LIME.html#LIMEIntuition"><i class="fa fa-check"></i><b>13.2</b> Intuition</a></li>
<li class="chapter" data-level="13.3" data-path="LIME.html"><a href="LIME.html#LIMEMethod"><i class="fa fa-check"></i><b>13.3</b> Method</a><ul>
<li class="chapter" data-level="13.3.1" data-path="LIME.html"><a href="LIME.html#interpretable-data-representation"><i class="fa fa-check"></i><b>13.3.1</b> Interpretable data representation</a></li>
<li class="chapter" data-level="13.3.2" data-path="LIME.html"><a href="LIME.html#sampling-around-the-instance-of-interest"><i class="fa fa-check"></i><b>13.3.2</b> Sampling around the instance of interest</a></li>
<li class="chapter" data-level="13.3.3" data-path="LIME.html"><a href="LIME.html#developing-the-white-box-model"><i class="fa fa-check"></i><b>13.3.3</b> Developing the white-box model</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="LIME.html"><a href="LIME.html#LIMEExample"><i class="fa fa-check"></i><b>13.4</b> Example: Titanic data</a></li>
<li class="chapter" data-level="13.5" data-path="LIME.html"><a href="LIME.html#LIMEProsCons"><i class="fa fa-check"></i><b>13.5</b> Pros and cons</a></li>
<li class="chapter" data-level="13.6" data-path="LIME.html"><a href="LIME.html#LIMERcode"><i class="fa fa-check"></i><b>13.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="13.6.1" data-path="LIME.html"><a href="LIME.html#the-lime-package"><i class="fa fa-check"></i><b>13.6.1</b> The lime package</a></li>
<li class="chapter" data-level="13.6.2" data-path="LIME.html"><a href="LIME.html#the-localmodel-package"><i class="fa fa-check"></i><b>13.6.2</b> The localModel package</a></li>
<li class="chapter" data-level="13.6.3" data-path="LIME.html"><a href="LIME.html#the-iml-package"><i class="fa fa-check"></i><b>13.6.3</b> The iml package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html"><i class="fa fa-check"></i><b>14</b> Summary of Instance-level Explainers</a><ul>
<li class="chapter" data-level="14.1" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#number-of-explanatory-variables-in-the-model"><i class="fa fa-check"></i><b>14.1</b> Number of explanatory variables in the model</a><ul>
<li class="chapter" data-level="14.1.1" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#low-to-medium-number-of-explanatory-variables"><i class="fa fa-check"></i><b>14.1.1</b> Low to medium number of explanatory variables</a></li>
<li class="chapter" data-level="14.1.2" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#medium-to-large-number-of-explanatory-variables"><i class="fa fa-check"></i><b>14.1.2</b> Medium to large number of explanatory variables</a></li>
<li class="chapter" data-level="14.1.3" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#very-large-number-of-explanatory-variables"><i class="fa fa-check"></i><b>14.1.3</b> Very large number of explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#correlated-explanatory-variables"><i class="fa fa-check"></i><b>14.2</b> Correlated explanatory variables</a></li>
<li class="chapter" data-level="14.3" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#models-with-interactions"><i class="fa fa-check"></i><b>14.3</b> Models with interactions</a></li>
<li class="chapter" data-level="14.4" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#sparse-explanations"><i class="fa fa-check"></i><b>14.4</b> Sparse explanations</a></li>
<li class="chapter" data-level="14.5" data-path="summaryInstanceLevel.html"><a href="summaryInstanceLevel.html#additional-uses-of-model-exploration-and-explanation"><i class="fa fa-check"></i><b>14.5</b> Additional uses of model exploration and explanation</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html"><i class="fa fa-check"></i><b>15</b> Use Case for FIFA 19</a><ul>
<li class="chapter" data-level="15.1" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#introduction-1"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#data-preparation-1"><i class="fa fa-check"></i><b>15.2</b> Data preparation</a></li>
<li class="chapter" data-level="15.3" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#model-assembly-1"><i class="fa fa-check"></i><b>15.3</b> Model assembly</a></li>
<li class="chapter" data-level="15.4" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#create-model-explaienrs"><i class="fa fa-check"></i><b>15.4</b> Create model explaienrs</a></li>
<li class="chapter" data-level="15.5" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#model-performance"><i class="fa fa-check"></i><b>15.5</b> Model performance</a></li>
<li class="chapter" data-level="15.6" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#feature-importance"><i class="fa fa-check"></i><b>15.6</b> Feature importance</a></li>
<li class="chapter" data-level="15.7" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#partial-dependency-profiles"><i class="fa fa-check"></i><b>15.7</b> Partial Dependency Profiles</a></li>
<li class="chapter" data-level="15.8" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#break-down"><i class="fa fa-check"></i><b>15.8</b> Break Down</a></li>
<li class="chapter" data-level="15.9" data-path="UseCaseFIFA.html"><a href="UseCaseFIFA.html#ceteris-paribus-profile"><i class="fa fa-check"></i><b>15.9</b> Ceteris Paribus Profile</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="modelLevelExploration.html"><a href="modelLevelExploration.html"><i class="fa fa-check"></i><b>16</b> Model-level exploration</a></li>
<li class="chapter" data-level="17" data-path="modelPerformance.html"><a href="modelPerformance.html"><i class="fa fa-check"></i><b>17</b> Model Performance Measures</a><ul>
<li class="chapter" data-level="17.1" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceIntro"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceIntuition"><i class="fa fa-check"></i><b>17.2</b> Intuition</a></li>
<li class="chapter" data-level="17.3" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethod"><i class="fa fa-check"></i><b>17.3</b> Method</a><ul>
<li class="chapter" data-level="17.3.1" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodCont"><i class="fa fa-check"></i><b>17.3.1</b> Continuous dependent variable</a></li>
<li class="chapter" data-level="17.3.2" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodBin"><i class="fa fa-check"></i><b>17.3.2</b> Binary dependent variable</a></li>
<li class="chapter" data-level="17.3.3" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodCateg"><i class="fa fa-check"></i><b>17.3.3</b> Categorical dependent variable</a></li>
<li class="chapter" data-level="17.3.4" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceMethodCount"><i class="fa fa-check"></i><b>17.3.4</b> Count dependent variable</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="modelPerformance.html"><a href="modelPerformance.html#example"><i class="fa fa-check"></i><b>17.4</b> Example</a><ul>
<li class="chapter" data-level="17.4.1" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceApartments"><i class="fa fa-check"></i><b>17.4.1</b> Apartments data</a></li>
<li class="chapter" data-level="17.4.2" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceTitanic"><i class="fa fa-check"></i><b>17.4.2</b> Titanic data</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceProsCons"><i class="fa fa-check"></i><b>17.5</b> Pros and cons</a></li>
<li class="chapter" data-level="17.6" data-path="modelPerformance.html"><a href="modelPerformance.html#modelPerformanceR"><i class="fa fa-check"></i><b>17.6</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="featureImportance.html"><a href="featureImportance.html"><i class="fa fa-check"></i><b>18</b> Variable’s Importance</a><ul>
<li class="chapter" data-level="18.1" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceIntro"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceIntuition"><i class="fa fa-check"></i><b>18.2</b> Intuition</a></li>
<li class="chapter" data-level="18.3" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceMethod"><i class="fa fa-check"></i><b>18.3</b> Method</a></li>
<li class="chapter" data-level="18.4" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceTitanic"><i class="fa fa-check"></i><b>18.4</b> Example: Titanic data</a></li>
<li class="chapter" data-level="18.5" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceProsCons"><i class="fa fa-check"></i><b>18.5</b> Pros and cons</a></li>
<li class="chapter" data-level="18.6" data-path="featureImportance.html"><a href="featureImportance.html#featureImportanceR"><i class="fa fa-check"></i><b>18.6</b> Code snippets for R</a></li>
<li class="chapter" data-level="18.7" data-path="featureImportance.html"><a href="featureImportance.html#more-models"><i class="fa fa-check"></i><b>18.7</b> More models</a></li>
<li class="chapter" data-level="18.8" data-path="featureImportance.html"><a href="featureImportance.html#level-frequency"><i class="fa fa-check"></i><b>18.8</b> Level frequency</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html"><i class="fa fa-check"></i><b>19</b> Partial Dependency Profiles</a><ul>
<li class="chapter" data-level="19.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPIntro"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPIntuition"><i class="fa fa-check"></i><b>19.2</b> Intuition</a></li>
<li class="chapter" data-level="19.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPMethod"><i class="fa fa-check"></i><b>19.3</b> Method</a><ul>
<li class="chapter" data-level="19.3.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#partial-dependency-profiles-1"><i class="fa fa-check"></i><b>19.3.1</b> Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.3.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#clustered-partial-dependency-profiles"><i class="fa fa-check"></i><b>19.3.2</b> Clustered Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.3.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#grouped-partial-dependency-profiles"><i class="fa fa-check"></i><b>19.3.3</b> Grouped Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.3.4" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#contrastive-partial-dependency-profiles"><i class="fa fa-check"></i><b>19.3.4</b> Contrastive Partial Dependency profiles</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPExample"><i class="fa fa-check"></i><b>19.4</b> Example: Apartments data</a><ul>
<li class="chapter" data-level="19.4.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#partial-dependency-profiles-2"><i class="fa fa-check"></i><b>19.4.1</b> Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.4.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#clustered-partial-dependency-profiles-1"><i class="fa fa-check"></i><b>19.4.2</b> Clustered Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.4.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#grouped-partial-dependency-profiles-1"><i class="fa fa-check"></i><b>19.4.3</b> Grouped Partial Dependency Profiles</a></li>
<li class="chapter" data-level="19.4.4" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#contrastive-partial-dependency-profiles-1"><i class="fa fa-check"></i><b>19.4.4</b> Contrastive Partial Dependency profiles</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPProsCons"><i class="fa fa-check"></i><b>19.5</b> Pros and cons</a></li>
<li class="chapter" data-level="19.6" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#PDPR"><i class="fa fa-check"></i><b>19.6</b> Code snippets for R</a><ul>
<li class="chapter" data-level="19.6.1" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#clustered-partial-dependency-profiles-2"><i class="fa fa-check"></i><b>19.6.1</b> Clustered Partial Dependency profiles</a></li>
<li class="chapter" data-level="19.6.2" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#grouped-partial-dependency-profiles-2"><i class="fa fa-check"></i><b>19.6.2</b> Grouped Partial Dependency profiles</a></li>
<li class="chapter" data-level="19.6.3" data-path="partialDependenceProfiles.html"><a href="partialDependenceProfiles.html#contrastive-partial-dependency-profiles-2"><i class="fa fa-check"></i><b>19.6.3</b> Contrastive Partial Dependency profiles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html"><i class="fa fa-check"></i><b>20</b> Accumulated Local Profiles</a><ul>
<li class="chapter" data-level="20.1" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPIntro"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
<li class="chapter" data-level="20.2" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPIntuition"><i class="fa fa-check"></i><b>20.2</b> Intuition</a></li>
<li class="chapter" data-level="20.3" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPMethod"><i class="fa fa-check"></i><b>20.3</b> Method</a><ul>
<li class="chapter" data-level="20.3.1" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#partial-dependency-profile"><i class="fa fa-check"></i><b>20.3.1</b> Partial Dependency Profile</a></li>
<li class="chapter" data-level="20.3.2" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#conditional-dependency-profile"><i class="fa fa-check"></i><b>20.3.2</b> Conditional Dependency Profile</a></li>
<li class="chapter" data-level="20.3.3" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#accumulated-local-profile"><i class="fa fa-check"></i><b>20.3.3</b> Accumulated Local Profile</a></li>
<li class="chapter" data-level="20.3.4" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#summaryFeatureEffects"><i class="fa fa-check"></i><b>20.3.4</b> Comparison of Explainers for Feature Effects</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#CDPExample"><i class="fa fa-check"></i><b>20.4</b> Example: Apartments data</a></li>
<li class="chapter" data-level="20.5" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPProsCons"><i class="fa fa-check"></i><b>20.5</b> Pros and cons</a></li>
<li class="chapter" data-level="20.6" data-path="accumulatedLocalProfiles.html"><a href="accumulatedLocalProfiles.html#ALPR"><i class="fa fa-check"></i><b>20.6</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html"><i class="fa fa-check"></i><b>21</b> Residual Diagnostic</a><ul>
<li class="chapter" data-level="21.1" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html#introduction-2"><i class="fa fa-check"></i><b>21.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html#intuition"><i class="fa fa-check"></i><b>21.2</b> Intuition</a></li>
<li class="chapter" data-level="21.3" data-path="residualDiagnostic.html"><a href="residualDiagnostic.html#code-snippets-for-r"><i class="fa fa-check"></i><b>21.3</b> Code snippets for R</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ccUseCase.html"><a href="ccUseCase.html"><i class="fa fa-check"></i><b>22</b> Use Case: Call Center</a><ul>
<li class="chapter" data-level="22.1" data-path="ccUseCase.html"><a href="ccUseCase.html#introduction-3"><i class="fa fa-check"></i><b>22.1</b> Introduction</a></li>
<li class="chapter" data-level="22.2" data-path="ccUseCase.html"><a href="ccUseCase.html#iteration-1-crisp-modeling"><i class="fa fa-check"></i><b>22.2</b> Iteration 1: Crisp modeling</a><ul>
<li class="chapter" data-level="22.2.1" data-path="ccUseCase.html"><a href="ccUseCase.html#data-preparation-2"><i class="fa fa-check"></i><b>22.2.1</b> Data preparation</a></li>
<li class="chapter" data-level="22.2.2" data-path="ccUseCase.html"><a href="ccUseCase.html#data-exploration-1"><i class="fa fa-check"></i><b>22.2.2</b> Data exploration</a></li>
<li class="chapter" data-level="22.2.3" data-path="ccUseCase.html"><a href="ccUseCase.html#model-assembly-2"><i class="fa fa-check"></i><b>22.2.3</b> Model assembly</a></li>
<li class="chapter" data-level="22.2.4" data-path="ccUseCase.html"><a href="ccUseCase.html#model-understanding-1"><i class="fa fa-check"></i><b>22.2.4</b> Model understanding</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="ccUseCase.html"><a href="ccUseCase.html#iteration-2-fine-tuning"><i class="fa fa-check"></i><b>22.3</b> Iteration 2: Fine tuning</a><ul>
<li class="chapter" data-level="22.3.1" data-path="ccUseCase.html"><a href="ccUseCase.html#analysis-of-residuals"><i class="fa fa-check"></i><b>22.3.1</b> Analysis of residuals</a></li>
<li class="chapter" data-level="22.3.2" data-path="ccUseCase.html"><a href="ccUseCase.html#sensitivity-analysis"><i class="fa fa-check"></i><b>22.3.2</b> Sensitivity analysis</a></li>
<li class="chapter" data-level="22.3.3" data-path="ccUseCase.html"><a href="ccUseCase.html#deeper-analysis-of-individual-observations"><i class="fa fa-check"></i><b>22.3.3</b> Deeper analysis of individual observations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendixes.html"><a href="appendixes.html"><i class="fa fa-check"></i>Appendixes</a></li>
<li class="chapter" data-level="23" data-path="conceptDrift.html"><a href="conceptDrift.html"><i class="fa fa-check"></i><b>23</b> Concept Drift</a><ul>
<li class="chapter" data-level="23.1" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftIntro"><i class="fa fa-check"></i><b>23.1</b> Introduction</a></li>
<li class="chapter" data-level="23.2" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftIntuition"><i class="fa fa-check"></i><b>23.2</b> Intuition</a></li>
<li class="chapter" data-level="23.3" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftMethod"><i class="fa fa-check"></i><b>23.3</b> Method</a></li>
<li class="chapter" data-level="23.4" data-path="conceptDrift.html"><a href="conceptDrift.html#covariate-drift"><i class="fa fa-check"></i><b>23.4</b> Covariate Drift</a></li>
<li class="chapter" data-level="23.5" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftExample"><i class="fa fa-check"></i><b>23.5</b> Example: Titanic data</a></li>
<li class="chapter" data-level="23.6" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftProsCons"><i class="fa fa-check"></i><b>23.6</b> Pros and cons</a></li>
<li class="chapter" data-level="23.7" data-path="conceptDrift.html"><a href="conceptDrift.html#DriftR"><i class="fa fa-check"></i><b>23.7</b> Code snippets for R</a></li>
<li class="chapter" data-level="23.8" data-path="conceptDrift.html"><a href="conceptDrift.html#residual-drift"><i class="fa fa-check"></i><b>23.8</b> Residual Drift</a></li>
<li class="chapter" data-level="23.9" data-path="conceptDrift.html"><a href="conceptDrift.html#code-snippets"><i class="fa fa-check"></i><b>23.9</b> Code snippets</a></li>
<li class="chapter" data-level="23.10" data-path="conceptDrift.html"><a href="conceptDrift.html#model-drift"><i class="fa fa-check"></i><b>23.10</b> Model Drift</a></li>
<li class="chapter" data-level="23.11" data-path="conceptDrift.html"><a href="conceptDrift.html#code-snippets-1"><i class="fa fa-check"></i><b>23.11</b> Code snippets</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="data-set-hr.html"><a href="data-set-hr.html"><i class="fa fa-check"></i><b>24</b> Data Set HR</a><ul>
<li class="chapter" data-level="24.1" data-path="data-set-hr.html"><a href="data-set-hr.html#HFDataset"><i class="fa fa-check"></i><b>24.1</b> Hire or fire</a><ul>
<li class="chapter" data-level="24.1.1" data-path="data-set-hr.html"><a href="data-set-hr.html#exploration-HR"><i class="fa fa-check"></i><b>24.1.1</b> Data exploration</a></li>
<li class="chapter" data-level="24.1.2" data-path="data-set-hr.html"><a href="data-set-hr.html#model-HR-mr"><i class="fa fa-check"></i><b>24.1.2</b> Multinomial logistic regression</a></li>
<li class="chapter" data-level="24.1.3" data-path="data-set-hr.html"><a href="data-set-hr.html#model-HR-rf"><i class="fa fa-check"></i><b>24.1.3</b> Random forest</a></li>
<li class="chapter" data-level="24.1.4" data-path="data-set-hr.html"><a href="data-set-hr.html#predictionsHR"><i class="fa fa-check"></i><b>24.1.4</b> Model predictions</a></li>
<li class="chapter" data-level="24.1.5" data-path="data-set-hr.html"><a href="data-set-hr.html#ListOfModelsHR"><i class="fa fa-check"></i><b>24.1.5</b> List of objects for the <code>HR</code> example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/pbiecek/DALEX" target="blank">DALEX website</a></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Predictive Models: Explore, Explain, and Debug</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="partialDependenceProfiles" class="section level1">
<h1><span class="header-section-number">Chapter 19</span> Partial Dependency Profiles</h1>
<div id="PDPIntro" class="section level2">
<h2><span class="header-section-number">19.1</span> Introduction</h2>
<p>One of the first and the most popular tools for inspection of black-box models on the global level are Partial Dependence Plots (sometimes called Partial Dependence Profiles).</p>
<p>PDP were introduced by Friedman in 2000 in his paper devoted to Gradient Boosting Machines (GBM) - new type of complex yet effective models <span class="citation">(Friedman <a href="#ref-Friedman00greedyfunction">2000</a>)</span>. For many years PDP as sleeping beauties stay in the shadow of the boosting method. But this has changed in recent years. PDP are very popular and available in most of data science languages. In this chapter we will introduce key intuitions, explain the math beyond PDP and discuss strengths and weaknesses.</p>
<p>General idea is to show how the expected model response behaves as a function of a selected feature. Here the term ,,expected’’ will be estimated simply as the average over the population of individual Ceteris Paribus Profiles introduced in Chapter <a href="ceterisParibus.html#ceterisParibus">7</a>.</p>
</div>
<div id="PDPIntuition" class="section level2">
<h2><span class="header-section-number">19.2</span> Intuition</h2>
<p>Ceteris paribus profiles intoriduces in the Section <a href="ceterisParibus.html#ceterisParibus">7</a> show profile of model response for a single observation.
Partial dependency profile is an average profile for all observations.</p>
<p>For additive models all ceteris paribus profiles are parallel. Same shape, just shifted up or down. But for complex models these profiles may be different.
Still, the average will be some crude summary how (in general) the model respond for changes in a given variable.</p>
<p>Left panel in the figure <a href="partialDependenceProfiles.html#fig:pdpIntuition">19.1</a> shows ceteris paribus profiles for 25 sample observations for Titanic data for random forest model <code>titanic_rf_v6</code>. The right panels show the average over CP profiles - it’s an estimate of partial dependency profile</p>
<div class="figure" style="text-align: center"><span id="fig:pdpIntuition"></span>
<img src="PM_VEE_files/figure-html/pdpIntuition-1.png" alt="(fig:pdpIntuition) Left panel: Ceteris Paribus profiles for selected 25 observations. Blue points stand for selected observations while cyan lines stand for ceteris paribus profiles. Right panel: Grey lines stand for Ceteris paribus profiles  as presented in left panel, blue line stands for its average - Partial dependency profile" width="100%" />
<p class="caption">
Figure 19.1: (fig:pdpIntuition) Left panel: Ceteris Paribus profiles for selected 25 observations. Blue points stand for selected observations while cyan lines stand for ceteris paribus profiles. Right panel: Grey lines stand for Ceteris paribus profiles as presented in left panel, blue line stands for its average - Partial dependency profile
</p>
</div>
</div>
<div id="PDPMethod" class="section level2">
<h2><span class="header-section-number">19.3</span> Method</h2>
<div id="partial-dependency-profiles-1" class="section level3">
<h3><span class="header-section-number">19.3.1</span> Partial Dependency Profiles</h3>
<p>Partial Dependency Profile for for a model <span class="math inline">\(f\)</span> and a variable <span class="math inline">\(x^j\)</span> is defined as</p>
<p><span class="math display">\[
g_{PD}^{f, j}(z) = E[f(x^j=z, X^{-j})] = E[f(x|^j=z)].
\]</span></p>
<p>So it’s an expected value for <span class="math inline">\(x^j = z\)</span> over <strong>marginal</strong> distribution <span class="math inline">\(X^{-j}\)</span> or equivalently expected value of <span class="math inline">\(f\)</span> after variable <span class="math inline">\(x^j\)</span> is set to <span class="math inline">\(z\)</span>.</p>
<p>The expectation cannot be calculated directly as we do not know fully neither the distribution of <span class="math inline">\(X^{-j}\)</span> nor the analytical formula of <span class="math inline">\(f\)</span>. Yet this value may be estimated by as average from CP profiles.</p>
<p><span class="math display" id="eq:PDPprofile">\[\begin{equation}
\hat g_{PD}^{f, j}(z) = \frac 1n \sum_{i=1}^{N} f(x_i^j=z, x^{-j}_i)] = \frac 1n \sum_{i=1}^{N} f(x_i|^j=z).
\tag{19.1}
\end{equation}\]</span></p>
<p>This formula comes from two steps.</p>
<ol style="list-style-type: decimal">
<li>Calculate ceteris paribus profiles for observations from the dataset.</li>
</ol>
<p>As it was introduced in <a href="ceterisParibus.html#ceterisParibus">7</a> ceteris paribus profiles show how model response change is a selected variable in this observation is modified.</p>
<p><span class="math display">\[
h^{f, j}_x(z) := f(x|^j = z).
\]</span></p>
<p>So for a single model and a single variable we get a bunch of <em>what-if</em> profiles. In the figure <a href="#fig:pdpPart1"><strong>??</strong></a> we show an example for 100 observations. Despite some variation (random forest are not as stable as we would hope) we see that most profiles are decreasing. So the older the passengers is the lower is the survival probability.</p>
<ol start="2" style="list-style-type: decimal">
<li>Aggregate Ceteris Paribus into a single Partial Dependency Profile</li>
</ol>
<p>Simple pointwise average across CP profiles. If number of CP profiles is large, it is enough to sample some number of them to get resonably accurate PD profiles.
This way we get the formula <a href="partialDependenceProfiles.html#eq:PDPprofile">(19.1)</a>.</p>
</div>
<div id="clustered-partial-dependency-profiles" class="section level3">
<h3><span class="header-section-number">19.3.2</span> Clustered Partial Dependency Profiles</h3>
<p>Partial pependency profile is a good summary if ceteris paribus profiles have similar shape, i.e. are parallel. But it may happen that the variable of interest is in interaction with some other variable. Not all profiles are parallel because the effect of variable of interest depends on some other variables.</p>
<p>If individual profiles have different shapes then simple average may be misleading.
To deal with this problem we propose to cluster Ceteris Paribus profiles and calculate average aggregate separately for each cluster.</p>
<p>The most straightforward approach would be to use a method for clustering and see how these cluster of profiles behave.
For clustering one may use standard algorithm like k-means or hierarchical clustering. Once clusters are established we can aggregate within clusters in the same way as in case of Ppartial dependency plots.</p>
<p>So for a single model and a single variable we get <span class="math inline">\(k\)</span> profiles average withing clusters.
See an example in Figure <a href="partialDependenceProfiles.html#fig:pdpPart4">19.2</a> created for random forest model. It is easier to notice that ceteris paribus profiles can be grouped in three clusters. Group of passengers with a very large drop in the survival (cluster 1), moderate drop (cluster 2) and almost no drop in survival (cluster 3). Here we do not know what other factors are linked with these clusters, but some additional exploratory analysis can be done to identify these factors.</p>
<div class="figure" style="text-align: center"><span id="fig:pdpPart4"></span>
<img src="PM_VEE_files/figure-html/pdpPart4-1.png" alt="(fig:pdpPart4) Grey lines stand for ceteris paribus profiles for 100 sample observations. These profiles were clusterd into 3 groups and blue, green and red lines show corresponding averages" width="75%" />
<p class="caption">
Figure 19.2: (fig:pdpPart4) Grey lines stand for ceteris paribus profiles for 100 sample observations. These profiles were clusterd into 3 groups and blue, green and red lines show corresponding averages
</p>
</div>
</div>
<div id="grouped-partial-dependency-profiles" class="section level3">
<h3><span class="header-section-number">19.3.3</span> Grouped Partial Dependency Profiles</h3>
<p>Once we see that variable of interest may be in interaction with some other variable, it is tempting to look for the factor that distinguish clusters.</p>
<p>The most straightforward approach is to use some other variable as a grouping variable.
Instead of clustering we may aggregate groups of CP profiles defined a a selected variable of itnerest.</p>
<p>See an example in Figure <a href="partialDependenceProfiles.html#fig:pdpPart5">19.3</a>. PD profiles are calculated separately for each gender. Clearly there is an interaction between Age and Sex. The survival for woman is more stable, while for man there is more sudden drop in Survival for older passengers.</p>
<div class="figure" style="text-align: center"><span id="fig:pdpPart5"></span>
<img src="PM_VEE_files/figure-html/pdpPart5-1.png" alt="Grouped profiles with respect to the gender variable" width="75%" />
<p class="caption">
Figure 19.3: Grouped profiles with respect to the gender variable
</p>
</div>
</div>
<div id="contrastive-partial-dependency-profiles" class="section level3">
<h3><span class="header-section-number">19.3.4</span> Contrastive Partial Dependency profiles</h3>
<p>In previous sections we compared PD profiles calculated for a single models but in groups either defined via clustering or via some dependent variable. Comparison of such aggregates overlayed in a single plot may be very insightful.
Contrastive comparisons of Partial Dependency Plots are useful not only for subgroups of observations but also for comparisons of different models.</p>
<p>Why one would like to compare models? There are at least three reasons for it.</p>
<ul>
<li><em>Agreement of models will be reassuring.</em> Some models are known to be more stable other to be more elastic. If profiles for models from these two classes are not far from each other we can be more convinced that elastic model is not over-fitted.</li>
<li><em>Disagreement of models suggest how to improve one of them.</em> If simpler interpretable model disagree with an elastic model, this may suggest a feature transformation that can be used to improve the interpretable model. For example if random forest learned non linear relation then it can be captures by a linear model after suitable transformation.</li>
<li><em>Validation of boundary conditions.</em> Some models are know to have different behavior on the boundary, for largest or lowest values. Random forest is known to shrink predictions towards the average, while support vector machines are known to have larger variance at edges. Contrastive comparisons may help to understand differences in boundary behavior.</li>
</ul>
<p>See an example in Figure <a href="partialDependenceProfiles.html#fig:pdpPart7">19.4</a>. Random forest model is compared with generalized linear model (logistic regression) with splines. Both models agree when it comes to a general relation between Age and chances of survival (the younger the better) but the curve for random forest is more flat. Difference between both models is largest for lowest values of the variable age. This observation is along out expectations that random forest model in general shrink towards an average and is not so good for interpolation outside the training domain.</p>
<div class="figure" style="text-align: center"><span id="fig:pdpPart7"></span>
<img src="PM_VEE_files/figure-html/pdpPart7-1.png" alt="Comparison of two predictive models with different structures traind on the same dataset `titanic`." width="75%" />
<p class="caption">
Figure 19.4: Comparison of two predictive models with different structures traind on the same dataset <code>titanic</code>.
</p>
</div>
</div>
</div>
<div id="PDPExample" class="section level2">
<h2><span class="header-section-number">19.4</span> Example: Apartments data</h2>
<p>In this section we will use random forest model <code>apartments_rf_v5</code> trained on <code>apartments</code> data in order to predict the price per square meter of an apartment. See section <a href="dataSetsIntro.html#model-Apartments-rf">5.2.3</a> for more details.
This example is focused on two dependent variables <code>surface</code> and <code>construction.year</code>.</p>
<div id="partial-dependency-profiles-2" class="section level3">
<h3><span class="header-section-number">19.4.1</span> Partial Dependency Profiles</h3>
<p>Figure <a href="partialDependenceProfiles.html#fig:pdpApartment1">19.5</a> presents CP profiles for 25 sample apartments along with the average PD profile.
It is interesting to see that relation between <code>surface</code> and the target variable is almost linear while relation between <code>construction.year</code> and the target variable is U-shaped. The most expensive are apartments very new or very old. The data is artificial but it was constructed in a way to reassemble effect of lower quality of building materials used in housing construction after II world war.</p>
<div class="figure" style="text-align: center"><span id="fig:pdpApartment1"></span>
<img src="PM_VEE_files/figure-html/pdpApartment1-1.png" alt="Ceteris Paribus profiles for 25 sample apartments and the partial dependency profile for the random forest model" width="75%" />
<p class="caption">
Figure 19.5: Ceteris Paribus profiles for 25 sample apartments and the partial dependency profile for the random forest model
</p>
</div>
</div>
<div id="clustered-partial-dependency-profiles-1" class="section level3">
<h3><span class="header-section-number">19.4.2</span> Clustered Partial Dependency Profiles</h3>
<p>A natural question would be to ask if the U-shape response profile for construction year is typical for all observations. Figure <a href="partialDependenceProfiles.html#fig:pdpApartment1clustered">19.6</a> shows average profiles in three clusters derived from the CP profiles.</p>
<p>Averages in clusters differ slightly in the size of oscillations, but all three shapes are similar. So far we do not have reasons to expect strong interactions in the model.</p>
<div class="figure" style="text-align: center"><span id="fig:pdpApartment1clustered"></span>
<img src="PM_VEE_files/figure-html/pdpApartment1clustered-1.png" alt="(fig:pdpApartment1clustered) Grey lines stand for ceteris paribus profiles for 25 sample observations. These profiles were clusterd into 3 groups and blue, green and red lines show corresponding averages" width="75%" />
<p class="caption">
Figure 19.6: (fig:pdpApartment1clustered) Grey lines stand for ceteris paribus profiles for 25 sample observations. These profiles were clusterd into 3 groups and blue, green and red lines show corresponding averages
</p>
</div>
</div>
<div id="grouped-partial-dependency-profiles-1" class="section level3">
<h3><span class="header-section-number">19.4.3</span> Grouped Partial Dependency Profiles</h3>
<p>One of categorical variables in the <code>apartments</code> dataset is the <code>district</code>. In this subsection we will check if the model behavior is similar for all districts. To to this we will calculate average ceteris paribus profiles for each district separately.</p>
<p>Figure <a href="partialDependenceProfiles.html#fig:pdpApartment2">19.7</a> shows PD profiles calculated independently for each district. There are some interesting things to see. First is that some profiles are higher than others, so for example apartments in <code>Srodmiescie</code> (downtown) are more expensive than in other districts. Second observation is that profiles are parallel, thus the effect of surface and construction year are similar in each district. Third is that these profiles constitute three groups of districts, the <code>Srodmiescie</code> (downtown), followed by three districts close to <code>Srodmiescie</code> (namely <code>Mokotow</code>, <code>Ochota</code> and <code>Ursynow</code>) followed by all other districts.</p>
<div class="figure" style="text-align: center"><span id="fig:pdpApartment2"></span>
<img src="PM_VEE_files/figure-html/pdpApartment2-1.png" alt="Partial dependency profiles calculated for separate districts." width="75%" />
<p class="caption">
Figure 19.7: Partial dependency profiles calculated for separate districts.
</p>
</div>
</div>
<div id="contrastive-partial-dependency-profiles-1" class="section level3">
<h3><span class="header-section-number">19.4.4</span> Contrastive Partial Dependency profiles</h3>
<p>One of the biggest challenges in modeling for complex model is if the model structure is flexible enough to capture relations present in the data, but not too flexible to avoid over fitting.</p>
<p>One approach to investigate this direction is to compare what has been learned by models with different structures. For example, figure <a href="partialDependenceProfiles.html#fig:pdpApartment3">19.8</a> shows PD profiles calculated for linear model and random forest model.</p>
<p>Here the story is very interesting. The linear model cannot of course capture the non monotonic relation between <code>construction.year</code> and the price per square meter. In case of the <code>surface</code> variable both models captured linear relation, but the one derived by <code>lm</code> model is steeper. It is expected for the random forest model to be biased towards the mean.</p>
<p>So one may say that both models missed something because of their structure. Linear model missed the U-shaped relation between construction year and apartment price while the random forest model shrink too much the effect of the surface over the apartment price.
Both these observations lead to the conclusion that we could build a better model that will capture both these relations.</p>
<div class="figure" style="text-align: center"><span id="fig:pdpApartment3"></span>
<img src="PM_VEE_files/figure-html/pdpApartment3-1.png" alt="(fig:pdpApartment3) Comparison of PD profiles for linear model and random forest model." width="75%" />
<p class="caption">
Figure 19.8: (fig:pdpApartment3) Comparison of PD profiles for linear model and random forest model.
</p>
</div>
</div>
</div>
<div id="PDPProsCons" class="section level2">
<h2><span class="header-section-number">19.5</span> Pros and cons</h2>
<p>Partial Dependency profiles, as presented in this chapter, offer a simple way to summaries an effect of a particular variable on the model response.</p>
<p>This method has numerous advantages. Just to name a few</p>
<ul>
<li>Partial Dependency profiles are quite popular and are implemented in variety of packages for R, python or other languages</li>
<li>Partial Dependency profiles are easy to explain and intuitive,</li>
<li>It is easy to extend PD profiles for different models or groups of observations.</li>
</ul>
<p>Yet there are also some disadvantages. They are mostly inherited from ceteris paribus profiles that are being aggregated.</p>
<ul>
<li>For correlated features the rule ,,all other things being constant’’ makes no sense. For the dataset <code>apartments</code> changes in <code>surface</code> should go along with changes in <code>number of rooms</code>. This issue will be discussed in the next chapter.</li>
<li>For non additive models the average across ceteris paribus profiles may be a crude and misleading simplification.</li>
</ul>
</div>
<div id="PDPR" class="section level2">
<h2><span class="header-section-number">19.6</span> Code snippets for R</h2>
<p>Here we show partial dependency profiles calculated with <code>ingredients</code> package <span class="citation">(Biecek et al. <a href="#ref-ingredientsRPackage">2019</a>)</span>. You will also find similar functions in the <code>pdp</code> package <span class="citation">(Greenwell <a href="#ref-pdpRPackage">2017</a>)</span>, <code>ALEPlots</code> package <span class="citation">(Apley <a href="#ref-ALEPlotRPackage">2018</a>)</span> or <code>iml</code> <span class="citation">(Molnar, Bischl, and Casalicchio <a href="#ref-imlRPackage">2018</a>)</span> package.</p>
<p>The easiest way to calculate PD profiles is to use the function <code>ingredients::partial_dependency</code>.
The only required argument is the explainer and by default PD profiles are calculated for all variables.</p>
<p>Below we use <code>variables</code> argument to limit list of variables for which PD profiles are calculated. Here we need profiles only for the <code>age</code> variable.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1">pdp_rf &lt;-<span class="st"> </span><span class="kw">partial_dependency</span>(explain_titanic_rf, <span class="dt">variables =</span> <span class="st">&quot;age&quot;</span>)</a>
<a class="sourceLine" id="cb159-2" data-line-number="2"><span class="kw">plot</span>(pdp_rf) <span class="op">+</span></a>
<a class="sourceLine" id="cb159-3" data-line-number="3"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Partial Dependency profile for age&quot;</span>) </a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pdpExample1"></span>
<img src="PM_VEE_files/figure-html/pdpExample1-1.png" alt="Partial Dependency profile for age." width="80%" />
<p class="caption">
Figure 19.9: Partial Dependency profile for age.
</p>
</div>
<p>PD profiles can be plotted on top of standard CP profiles. This is a very useful feature if we want to know how crude is the averaging and how similar are individual profiles to the average.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1">selected_passangers &lt;-<span class="st"> </span><span class="kw">select_sample</span>(titanic, <span class="dt">n =</span> <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb160-2" data-line-number="2">cp_rf &lt;-<span class="st"> </span><span class="kw">ceteris_paribus</span>(explain_titanic_rf, selected_passangers, <span class="dt">variables =</span> <span class="st">&quot;age&quot;</span>)</a>
<a class="sourceLine" id="cb160-3" data-line-number="3"></a>
<a class="sourceLine" id="cb160-4" data-line-number="4"><span class="kw">plot</span>(cp_rf, <span class="dt">variables =</span> <span class="st">&quot;age&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb160-5" data-line-number="5"><span class="st">  </span><span class="kw">show_aggregated_profiles</span>(pdp_rf, <span class="dt">variables =</span> <span class="st">&quot;age&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb160-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Ceteris Paribus and Partial Dependency profiles for age&quot;</span>) </a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pdpExample2"></span>
<img src="PM_VEE_files/figure-html/pdpExample2-1.png" alt="Ceteris Paribus and Partial Dependency profiles for age." width="80%" />
<p class="caption">
Figure 19.10: Ceteris Paribus and Partial Dependency profiles for age.
</p>
</div>
<div id="clustered-partial-dependency-profiles-2" class="section level3">
<h3><span class="header-section-number">19.6.1</span> Clustered Partial Dependency profiles</h3>
<p>In order to calculate clustered profiles we need to first calculate CP profiles with the <code>ceteris_paribus</code> function.</p>
<p>Then we can use the <code>cluster_profiles</code> function, which performs k-means clustering in ceteris paribus profiles.</p>
<p>The clustered profiles can be the plotted with the <code>plot</code> function.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1">selected_passangers &lt;-<span class="st"> </span><span class="kw">select_sample</span>(titanic, <span class="dt">n =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb161-2" data-line-number="2">cp_rf &lt;-<span class="st"> </span><span class="kw">ceteris_paribus</span>(explain_titanic_rf, selected_passangers, <span class="dt">variables =</span> <span class="st">&quot;age&quot;</span>)</a>
<a class="sourceLine" id="cb161-3" data-line-number="3"></a>
<a class="sourceLine" id="cb161-4" data-line-number="4">clust_rf &lt;-<span class="st"> </span><span class="kw">cluster_profiles</span>(cp_rf, <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">center =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb161-5" data-line-number="5"></a>
<a class="sourceLine" id="cb161-6" data-line-number="6"><span class="kw">plot</span>(cp_rf, <span class="dt">color =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb161-7" data-line-number="7"><span class="st">  </span><span class="kw">show_aggregated_profiles</span>(clust_rf, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;_label_&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb161-8" data-line-number="8"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Clustered Partial Dependency profiles.&quot;</span>) </a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pdpExample3"></span>
<img src="PM_VEE_files/figure-html/pdpExample3-1.png" alt="Clustered Partial Dependency profiles." width="80%" />
<p class="caption">
Figure 19.11: Clustered Partial Dependency profiles.
</p>
</div>
</div>
<div id="grouped-partial-dependency-profiles-2" class="section level3">
<h3><span class="header-section-number">19.6.2</span> Grouped Partial Dependency profiles</h3>
<p>The <code>partial_dependency</code> has argument <code>groups</code>. It is enough to set this argument to some categorical variable to calculate and plot Grouped Partial Dependency profiles.</p>
<p>In the example below we plot groups separately for each gender.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1">pdp_sex_rf &lt;-<span class="st"> </span><span class="kw">partial_dependency</span>(cp_rf, <span class="dt">variables =</span> <span class="st">&quot;age&quot;</span>,</a>
<a class="sourceLine" id="cb162-2" data-line-number="2">                <span class="dt">groups =</span> <span class="st">&quot;gender&quot;</span>)</a>
<a class="sourceLine" id="cb162-3" data-line-number="3"></a>
<a class="sourceLine" id="cb162-4" data-line-number="4"><span class="kw">plot</span>(cp_rf, <span class="dt">variables =</span> <span class="st">&quot;age&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb162-5" data-line-number="5"><span class="st">  </span><span class="kw">show_aggregated_profiles</span>(pdp_sex_rf, <span class="dt">variables =</span> <span class="st">&quot;age&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb162-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Grouped Partial Dependency profiles&quot;</span>) </a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pdpExample4"></span>
<img src="PM_VEE_files/figure-html/pdpExample4-1.png" alt="Grouped Partial Dependency profiles." width="80%" />
<p class="caption">
Figure 19.12: Grouped Partial Dependency profiles.
</p>
</div>
</div>
<div id="contrastive-partial-dependency-profiles-2" class="section level3">
<h3><span class="header-section-number">19.6.3</span> Contrastive Partial Dependency profiles</h3>
<p>As in previous functions, in order to overlay explanations for two or model models in a single plot one can use the generic <code>plot()</code> function.</p>
<p>In the example below we create PD profiles for <code>explain_titanic_rf</code> and <code>explain_titanic_lmr</code> models and then they are plotted together in a single plot.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1">pdp_rf &lt;-<span class="st"> </span><span class="kw">partial_dependency</span>(explain_titanic_rf, <span class="dt">variables =</span> <span class="st">&quot;age&quot;</span>)</a>
<a class="sourceLine" id="cb163-2" data-line-number="2">pdp_lmr &lt;-<span class="st"> </span><span class="kw">partial_dependency</span>(explain_titanic_lmr, <span class="dt">variables =</span> <span class="st">&quot;age&quot;</span>)</a>
<a class="sourceLine" id="cb163-3" data-line-number="3"></a>
<a class="sourceLine" id="cb163-4" data-line-number="4"><span class="kw">plot</span>(pdp_rf, pdp_lmr) <span class="op">+</span></a>
<a class="sourceLine" id="cb163-5" data-line-number="5"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Contrastive Partial Dependency profiles&quot;</span>) </a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pdpExample5"></span>
<img src="PM_VEE_files/figure-html/pdpExample5-1.png" alt="Contrastive Partial Dependency profiles." width="80%" />
<p class="caption">
Figure 19.13: Contrastive Partial Dependency profiles.
</p>
</div>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-ALEPlotRPackage">
<p>Apley, Dan. 2018. <em>ALEPlot: Accumulated Local Effects (Ale) Plots and Partial Dependence (Pd) Plots</em>. <a href="https://CRAN.R-project.org/package=ALEPlot">https://CRAN.R-project.org/package=ALEPlot</a>.</p>
</div>
<div id="ref-ingredientsRPackage">
<p>Biecek, Przemyslaw, Hubert Baniecki, Adam Izdebski, and Katarzyna Pekala. 2019. <em>Ingredients: Effects and Importances of Model Ingredients</em>.</p>
</div>
<div id="ref-Friedman00greedyfunction">
<p>Friedman, Jerome H. 2000. “Greedy Function Approximation: A Gradient Boosting Machine.” <em>Annals of Statistics</em> 29: 1189–1232.</p>
</div>
<div id="ref-pdpRPackage">
<p>Greenwell, Brandon M. 2017. “pdp: An R Package for Constructing Partial Dependence Plots.” <em>The R Journal</em> 9 (1): 421–36. <a href="https://journal.r-project.org/archive/2017/RJ-2017-016/index.html">https://journal.r-project.org/archive/2017/RJ-2017-016/index.html</a>.</p>
</div>
<div id="ref-imlRPackage">
<p>Molnar, Christoph, Bernd Bischl, and Giuseppe Casalicchio. 2018. “iml: An R package for Interpretable Machine Learning.” <em>JOSS</em> 3 (26). Journal of Open Source Software: 786. <a href="https://doi.org/10.21105/joss.00786">https://doi.org/10.21105/joss.00786</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="featureImportance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="accumulatedLocalProfiles.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["PM_VEE.pdf", "PM_VEE.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
